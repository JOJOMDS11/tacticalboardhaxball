(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))o(n);new MutationObserver(n=>{for(const r of n)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function i(n){const r={};return n.integrity&&(r.integrity=n.integrity),n.referrerPolicy&&(r.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?r.credentials="include":n.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function o(n){if(n.ep)return;n.ep=!0;const r=i(n);fetch(n.href,r)}})();const j={442:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.35,y:.25},{id:"MC",x:.35,y:.5},{id:"MC",x:.35,y:.75},{id:"MEI",x:.48,y:.47},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.8,y:.15},{id:"ZAG",x:.8,y:.35},{id:"ZAG",x:.8,y:.65},{id:"LD",x:.8,y:.85},{id:"VOL",x:.65,y:.25},{id:"MC",x:.65,y:.5},{id:"MC",x:.65,y:.75},{id:"MEI",x:.52,y:.53},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},433:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.32,y:.5},{id:"MC",x:.42,y:.3},{id:"MC",x:.42,y:.7},{id:"PE",x:.58,y:.2},{id:"ATA",x:.65,y:.5},{id:"PD",x:.58,y:.8}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.82,y:.15},{id:"ZAG",x:.82,y:.35},{id:"ZAG",x:.82,y:.65},{id:"LD",x:.82,y:.85},{id:"VOL",x:.68,y:.5},{id:"MC",x:.58,y:.3},{id:"MC",x:.58,y:.7},{id:"PE",x:.42,y:.2},{id:"ATA",x:.35,y:.5},{id:"PD",x:.42,y:.8}]},352:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"VOL",x:.38,y:.5},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"VOL",x:.62,y:.5},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},343:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"MEI",x:.48,y:.5},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"MEI",x:.52,y:.5},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]}},I={"3x3":{futsal:{backgroundImage:"https://i.imgur.com/UiOK7Gr.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"4x4":{futsal:{backgroundImage:"https://i.imgur.com/dZgIa0e.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"7x7":{futsal:{backgroundImage:"https://i.imgur.com/n56z593.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:25},{uid:2,id:"LD",team:"red",x:.2,y:.2,size:25},{uid:3,id:"PD",team:"red",x:.35,y:.2,size:25},{uid:4,id:"MC",team:"red",x:.15,y:.6,size:25},{uid:5,id:"LE",team:"red",x:.2,y:.8,size:25},{uid:6,id:"PV",team:"red",x:.35,y:.5,size:25},{uid:7,id:"PE",team:"red",x:.35,y:.8,size:25},{uid:8,id:"GK",team:"blue",x:.95,y:.5,size:25},{uid:9,id:"LD",team:"blue",x:.8,y:.2,size:25},{uid:10,id:"PD",team:"blue",x:.65,y:.2,size:25},{uid:11,id:"MC",team:"blue",x:.85,y:.6,size:25},{uid:12,id:"LE",team:"blue",x:.8,y:.8,size:25},{uid:13,id:"PV",team:"blue",x:.65,y:.5,size:25},{uid:14,id:"PE",team:"blue",x:.65,y:.8,size:25},{uid:15,id:"",team:"ball",x:.5,y:.5,size:10}]}},"11x11":{futsal:{backgroundImage:"https://i.imgur.com/TMJUugB.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.2,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.2,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.2,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.2,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.35,y:.25,size:22},{uid:7,id:"MC",team:"red",x:.35,y:.5,size:22},{uid:8,id:"MC",team:"red",x:.35,y:.75,size:22},{uid:9,id:"MEI",team:"red",x:.48,y:.47,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.35,size:22},{uid:11,id:"ATA",team:"red",x:.65,y:.65,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.8,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.8,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.8,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.8,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.65,y:.25,size:22},{uid:18,id:"MC",team:"blue",x:.65,y:.5,size:22},{uid:19,id:"MC",team:"blue",x:.65,y:.75,size:22},{uid:20,id:"MEI",team:"blue",x:.52,y:.53,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.35,size:22},{uid:22,id:"ATA",team:"blue",x:.35,y:.65,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:10}]},realsoccer:{backgroundImage:"https://i.imgur.com/VJ0hQX5.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.18,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.18,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.18,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.18,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.32,y:.5,size:22},{uid:7,id:"MC",team:"red",x:.42,y:.3,size:22},{uid:8,id:"MC",team:"red",x:.42,y:.7,size:22},{uid:9,id:"PE",team:"red",x:.58,y:.2,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.5,size:22},{uid:11,id:"PD",team:"red",x:.58,y:.8,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.82,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.82,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.82,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.82,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.68,y:.5,size:22},{uid:18,id:"MC",team:"blue",x:.58,y:.3,size:22},{uid:19,id:"MC",team:"blue",x:.58,y:.7,size:22},{uid:20,id:"PE",team:"blue",x:.42,y:.2,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.5,size:22},{uid:22,id:"PD",team:"blue",x:.42,y:.8,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:8}]}}};class ne{constructor(){console.log("Usando hitwebcounter para contagem de visitantes")}async trackVisit(){}async trackDownload(){}async trackDraw(){}async trackLanguageChange(){}async trackDiscordClick(){}async trackConfigChange(){}}const C=new ne,x=document.getElementById("board"),l=document.getElementById("drawLayer"),M=document.getElementById("players");(!x||!l||!M)&&console.error("Elementos HTML não encontrados!",{board:x,draw:l,playersLayer:M});const a=l?.getContext("2d");let h="line",O=!1,v=!1,L=null,g=null,y=[];const oe=10;let s="pt",b="3x3",B="futsal",R=[],V=!1,T=null,A=!0,q="#B917FF",H="#ff0000",F="#ff4444",Y="#4444ff",k=[...I[b][B].players];const m={pt:{drawOnBtn:"Ativar Desenho",drawOffBtn:"Desativar Desenho",eraseBtn:"Borracha",clearBtn:"Limpar",colorLabel:"Cor:",downloadBtn:"Baixar PNG",freeBtn:"Livre",lineBtn:"Linha",squareBtn:"Quadrado",triangleBtn:"Triângulo",circleBtn:"Círculo",arrowBtn:"Seta",strokeSizeLabel:"Tamanho do Traço:",eraserSizeLabel:"Tamanho da Borracha:",discordMessage:"ENTRE AGORA MESMO EM NOSSO DISCORD PARA PARTICIPAR DOS EVENTOS.",creditsLabel:"Feito por:",helpProject:"Ajude o projeto",teamSizeLabel:"Tamanho do Time:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Em breve!",primaryColorLabel:"Cor Primária:",secondaryColorLabel:"Cor Secundária:",tipsButton:"💡 Dicas",viewerCount:"Visitantes",toggleShadowBtn:"Ativar Sombra"},en:{drawOnBtn:"Activate Draw",drawOffBtn:"Deactivate Draw",eraseBtn:"Eraser",clearBtn:"Clear",colorLabel:"Color:",downloadBtn:"Download PNG",freeBtn:"Free",lineBtn:"Line",squareBtn:"Square",triangleBtn:"Triangle",circleBtn:"Circle",arrowBtn:"Arrow",strokeSizeLabel:"Stroke Size:",eraserSizeLabel:"Eraser Size:",discordMessage:"JOIN OUR DISCORD NOW TO PARTICIPATE IN EVENTS.",creditsLabel:"Made by:",helpProject:"Help the project",teamSizeLabel:"Team Size:",mapTypeLabel:"Map Type:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Coming soon!",primaryColorLabel:"Primary Color:",secondaryColorLabel:"Secondary Color:",tipsButton:"💡 Tips",viewerCount:"Visitors",toggleShadowBtn:"Toggle Shadow"},tr:{drawOnBtn:"Çizimi Etkinleştir",drawOffBtn:"Çizimi Devre Dışı Bırak",eraseBtn:"Silgi",clearBtn:"Temizle",colorLabel:"Renk:",downloadBtn:"PNG İndir",freeBtn:"Serbest",lineBtn:"Çizgi",squareBtn:"Kare",triangleBtn:"Üçgen",circleBtn:"Çember",arrowBtn:"Ok",strokeSizeLabel:"Çizgi Kalınlığı:",eraserSizeLabel:"Silgi Boyutu:",discordMessage:"ETKİNLİKLERE KATILMAK İÇİN DISCORD'UMUZA HEMEN KATILIN.",creditsLabel:"Yapılan:",helpProject:"Projeye yardım et",teamSizeLabel:"Takım Boyutu:",mapTypeLabel:"Harita Tipi:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Yakında!",primaryColorLabel:"Birincil Renk:",secondaryColorLabel:"İkincil Renk:",tipsButton:"💡 İpuçları",viewerCount:"Ziyaretçiler",toggleShadowBtn:"Gölge Aç/Kapat"},es:{drawOnBtn:"Activar Dibujo",drawOffBtn:"Desactivar Dibujo",eraseBtn:"Goma",clearBtn:"Limpiar",colorLabel:"Color:",downloadBtn:"Descargar PNG",freeBtn:"Libre",lineBtn:"Línea",squareBtn:"Cuadrado",triangleBtn:"Triángulo",circleBtn:"Círculo",arrowBtn:"Flecha",strokeSizeLabel:"Grosor del Trazo:",eraserSizeLabel:"Tamaño de la Goma:",discordMessage:"ÚNETE A NUESTRO DISCORD AHORA PARA PARTICIPAR EN LOS EVENTOS.",creditsLabel:"Hecho por:",helpProject:"Ayuda al proyecto",teamSizeLabel:"Tamaño del Equipo:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal",comingSoon:"¡Próximamente!",primaryColorLabel:"Color Primario:",secondaryColorLabel:"Color Secundario:",tipsButton:"💡 Consejos",viewerCount:"Visitantes",toggleShadowBtn:"Activar Sombra"}};function W(){const t=b,e=B.charAt(0).toUpperCase()+B.slice(1);document.getElementById("currentModeLabel").textContent=`— ${t} ${e}`}function J(){const t=document.getElementById("teamSizeSelect"),e=document.getElementById("mapTypeSelect");t.innerHTML="",e.innerHTML="",Object.keys(I).forEach(i=>{const o=document.createElement("option");o.value=i,o.textContent=i,i===b&&(o.selected=!0),t.appendChild(o)}),I[b]&&Object.keys(I[b]).forEach(i=>{const o=document.createElement("option");o.value=i,o.textContent=i.charAt(0).toUpperCase()+i.slice(1),i===B&&(o.selected=!0),e.appendChild(o)})}function z(){const t={drawOnBtn:m[s].drawOnBtn,drawOffBtn:m[s].drawOffBtn,eraseBtn:m[s].eraseBtn,clearBtn:m[s].clearBtn,downloadBtn:m[s].downloadBtn,freeBtn:m[s].freeBtn,lineBtn:m[s].lineBtn,squareBtn:m[s].squareBtn,triangleBtn:m[s].triangleBtn,circleBtn:m[s].circleBtn,arrowBtn:m[s].arrowBtn,tipsBtn:m[s].tipsButton,toggleShadowBtn:A?s==="pt"?"Desativar Sombra":s==="en"?"Disable Shadow":s==="tr"?"Gölgeyi Kapat":"Desactivar Sombra":m[s].toggleShadowBtn};Object.keys(t).forEach(o=>{const n=document.getElementById(o);n?n.textContent=t[o]:console.warn(`Elemento não encontrado: ${o}`)});const e={strokeSizeLabel:m[s].strokeSizeLabel,eraserSizeLabel:m[s].eraserSizeLabel,primaryColorLabel:m[s].primaryColorLabel,secondaryColorLabel:m[s].secondaryColorLabel,creditsLabel:m[s].creditsLabel,helpProjectLabel:m[s].helpProject,teamSizeLabel:m[s].teamSizeLabel,mapTypeLabel:m[s].mapTypeLabel};Object.keys(e).forEach(o=>{const n=document.getElementById(o);n&&(n.textContent=e[o])});const i=document.querySelector(".discord-message a");i&&(i.textContent=m[s].discordMessage),document.querySelectorAll(".language-selector img").forEach(o=>{o.classList.remove("active")}),document.getElementById(`flag-${s}`).classList.add("active"),C.updateViewerDisplay(),W()}document.getElementById("flag-pt").addEventListener("click",()=>{s="pt",z(),C.trackLanguageChange("pt")});document.getElementById("flag-en").addEventListener("click",()=>{s="en",z(),C.trackLanguageChange("en")});document.getElementById("flag-tr").addEventListener("click",()=>{s="tr",z(),C.trackLanguageChange("tr")});document.getElementById("flag-es").addEventListener("click",()=>{s="es",z(),C.trackLanguageChange("es")});document.getElementById("teamSizeSelect").addEventListener("change",t=>{const e=t.target.value;if(I[e]){const i=Object.keys(I[e]),o=i.includes(B)?B:i[0];Z(e,o),C.trackConfigChange("team_size",e)}else t.target.value=b,alert(m[s].comingSoon)});document.getElementById("mapTypeSelect").addEventListener("change",t=>{const e=t.target.value;I[b]&&I[b][e]?(Z(b,e),C.trackConfigChange("map_type",e)):(t.target.value=B,alert(m[s].comingSoon))});function Z(t,e){b=t,B=e;const i=document.getElementById("formationSelectors");t==="11x11"?i.style.display="flex":i.style.display="none",M.innerHTML="";let o=I[t][e];if(k=[...o.players],t==="11x11"){const n=document.getElementById("redFormationSelect").value,r=document.getElementById("blueFormationSelect").value;let d=j[n].red.map((w,f)=>({uid:f+1,id:w.id,team:"red",x:w.x,y:w.y,size:22})),p=j[r].blue.map((w,f)=>({uid:f+12,id:w.id,team:"blue",x:w.x,y:w.y,size:22})),u={uid:23,id:"",team:"ball",x:.5,y:.5,size:10};k=[...d,...p,u]}x.style.backgroundImage=`url('${o.backgroundImage}')`,k.forEach(n=>{const r=document.createElement("div");r.className=`player ${n.team}`,r.textContent=n.id,r.dataset.uid=n.uid,r.style.setProperty("--size",`${n.size}px`),M.appendChild(r),n.el=r}),K(),a.clearRect(0,0,l.width,l.height),y=[],R=[],J(),W()}document.querySelector(".discord-message a").addEventListener("click",()=>{C.trackDiscordClick()});function $(){y.length>=oe&&y.shift(),y.push(l.toDataURL())}function re(){if(y.length>0)if(y.pop(),y.length>0){const t=new Image;t.onload=()=>{a.clearRect(0,0,l.width,l.height),a.drawImage(t,0,0),S()},t.src=y[y.length-1]}else a.clearRect(0,0,l.width,l.height),S()}function N(){if(!l||!x||!a){console.error("Canvas ou elementos não encontrados para resize");return}if(l.width=x.clientWidth,l.height=x.clientHeight,y.length>0){const t=new Image;t.onload=()=>{a.drawImage(t,0,0),S()},t.src=y[y.length-1]}else S()}window.addEventListener("resize",N);N();k.forEach(t=>{const e=document.createElement("div");e.className=`player ${t.team}`,e.textContent=t.id,e.dataset.uid=t.uid,e.style.setProperty("--size",`${t.size}px`),M.appendChild(e),t.el=e});function K(){const t=x.getBoundingClientRect();k.forEach(e=>{const i=e.size||29;e.el.style.left=e.x*t.width-i/2+"px",e.el.style.top=e.y*t.height-i/2+"px"})}K();window.addEventListener("resize",K);let c=null;x.addEventListener("pointerdown",t=>{const e=t.target.closest(".player");if(!e)return;const i=x.getBoundingClientRect(),o=e.dataset.uid,n=k.find(r=>r.uid==o);if(n){if(n.size,t.button===2){t.preventDefault(),A&&(V=!0,T={x:n.x,y:n.y,player:n}),c={p:n,offsetX:t.clientX-i.left-n.x*i.width,offsetY:t.clientY-i.top-n.y*i.height},e.setPointerCapture(t.pointerId);return}c={p:n,offsetX:t.clientX-i.left-n.x*i.width,offsetY:t.clientY-i.top-n.y*i.height},e.setPointerCapture(t.pointerId)}});window.addEventListener("pointermove",t=>{if(!c)return;const e=x.getBoundingClientRect(),i=c.p.size||29;c.p.x=(t.clientX-e.left-c.offsetX)/e.width,c.p.y=(t.clientY-e.top-c.offsetY)/e.height;const o=i/2/e.width,n=1-i/2/e.width,r=i/2/e.height,d=1-i/2/e.height;if(c.p.x=Math.max(o,Math.min(c.p.x,n)),c.p.y=Math.max(r,Math.min(c.p.y,d)),K(),V&&T){if(a.clearRect(0,0,l.width,l.height),y.length>0){const G=new Image;G.src=y[y.length-1],a.drawImage(G,0,0)}S();const p=T.x*e.width,u=T.y*e.height,w=c.p.x*e.width,f=c.p.y*e.height;a.strokeStyle="#ffff00",a.lineWidth=2,a.setLineDash([5,5]),a.beginPath(),a.moveTo(p,u),a.lineTo(w,f),a.stroke(),a.setLineDash([]);const D=c.p.size||29;a.save(),a.globalAlpha=.5,a.beginPath(),a.arc(p,u,D/2-2,0,Math.PI*2),a.fillStyle=c.p.team==="red"?"#e53935":c.p.team==="blue"?"#1e88e5":"#B917FF",a.fill(),a.strokeStyle="black",a.lineWidth=2,a.stroke(),c.p.id&&(a.font=`bold ${Math.max(10,D*.4)}px Arial, sans-serif`,a.fillStyle="white",a.textAlign="center",a.textBaseline="middle",a.fillText(c.p.id,p,u)),a.restore()}});window.addEventListener("pointerup",t=>{if(V&&T){if(R.push({startX:T.x,startY:T.y,endX:c.p.x,endY:c.p.y,playerId:c.p.uid,playerSize:c.p.size||29,playerTeam:c.p.team,playerText:c.p.id}),a.clearRect(0,0,l.width,l.height),y.length>0){const e=new Image;e.onload=()=>{a.drawImage(e,0,0),S(),$()},e.src=y[y.length-1]}else S(),$();V=!1,T=null}c=null});function P(t){if(!l)return{x:0,y:0};const e=l.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function S(){if(!a||!x)return;const t=x.getBoundingClientRect();R.forEach(e=>{const i=e.startX*t.width,o=e.startY*t.height,n=e.endX*t.width,r=e.endY*t.height,d=e.playerTeam==="red"?F:e.playerTeam==="blue"?Y:"#ffff00";a.strokeStyle=d,a.lineWidth=2,a.setLineDash([5,5]),a.beginPath(),a.moveTo(i,o),a.lineTo(n,r),a.stroke(),a.setLineDash([]);const p=e.playerSize;a.save(),a.globalAlpha=.5,a.beginPath(),a.arc(n,r,p/2-2,0,Math.PI*2);const u=e.playerTeam==="red"?F:e.playerTeam==="blue"?Y:"#B917FF";a.fillStyle=u,a.fill(),a.strokeStyle="black",a.lineWidth=2,a.stroke(),e.playerText&&(a.font=`bold ${Math.max(10,p*.4)}px Arial, sans-serif`,a.fillStyle="white",a.textAlign="center",a.textBaseline="middle",a.fillText(e.playerText,n,r)),a.restore()})}function Q(t){const e=P(t);if(a.clearRect(0,0,l.width,l.height),y.length>0){const o=new Image;o.src=y[y.length-1],a.drawImage(o,0,0)}const i=t.button===2?H:q;if(a.strokeStyle=i,a.lineWidth=document.getElementById("sizePicker").value,a.lineCap="round",a.beginPath(),h==="line")a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.stroke();else if(h==="square"){const o=e.x-g.x,n=e.y-g.y;a.strokeRect(g.x,g.y,o,n)}else if(h==="triangle")a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.lineTo(g.x+(e.x-g.x)/2,g.y),a.closePath(),a.stroke();else if(h==="circle"){const o=e.x-g.x,n=e.y-g.y,r=Math.sqrt(o*o+n*n)/2;a.arc(g.x+o/2,g.y+n/2,r,0,2*Math.PI),a.stroke()}else if(h==="arrow"){const n=Math.atan2(e.y-g.y,e.x-g.x);a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.stroke(),a.beginPath(),a.moveTo(e.x,e.y),a.lineTo(e.x-15*Math.cos(n-Math.PI/6),e.y-15*Math.sin(n-Math.PI/6)),a.lineTo(e.x-15*Math.cos(n+Math.PI/6),e.y-15*Math.sin(n+Math.PI/6)),a.closePath(),a.fillStyle=a.strokeStyle,a.fill()}}function le(t){if(v){O=!0,L=P(t);return}if(h!==null)if($(),O=!0,h==="free"){L=P(t);const e=t.button===2?H:q;a.strokeStyle=e,a.lineWidth=document.getElementById("sizePicker").value,a.lineCap="round",a.beginPath(),a.moveTo(L.x,L.y)}else g=P(t),L=P(t)}function se(t){if(O)if(v){const e=P(t);a.lineWidth=document.getElementById("eraserSizePicker").value,a.lineCap="round",a.globalCompositeOperation="destination-out",a.beginPath(),a.moveTo(L.x,L.y),a.lineTo(e.x,e.y),a.stroke(),L=e}else if(h==="free"){const e=P(t);a.globalCompositeOperation="source-over",a.lineTo(e.x,e.y),a.stroke(),L=e}else Q(t)}function _(t){O&&(v||(h==="free"||Q(t),S(),$()),O=!1,L=null,g=null,a.globalCompositeOperation="source-over")}l.addEventListener("mousedown",le);l.addEventListener("mousemove",se);window.addEventListener("mouseup",_);l.addEventListener("mouseleave",_);l.addEventListener("contextmenu",t=>t.preventDefault());l.addEventListener("contextmenu",t=>t.preventDefault());x.addEventListener("contextmenu",t=>{t.target.closest(".player")&&t.preventDefault()});window.addEventListener("keydown",t=>{const e=document.getElementById("tactical-tab");e&&e.classList.contains("active")&&(t.ctrlKey&&(t.key==="z"||t.key==="Z")&&(t.preventDefault(),console.log("Ctrl+Z pressed, undoing...","History length:",y.length),re()),t.ctrlKey&&(t.key==="d"||t.key==="D")&&(t.preventDefault(),ee()),t.ctrlKey&&(t.key==="s"||t.key==="S")&&(t.preventDefault(),te()),t.ctrlKey&&(t.key==="l"||t.key==="L")&&(t.preventDefault(),de()))});function ee(){h!==null&&!v?(h=null,v=!1,l.style.pointerEvents="none",E("drawOffBtn"),console.log("Modo de desenho desativado (Ctrl+D)")):(A=!1,v=!1,h="line",l.style.pointerEvents="auto",E("drawOnBtn"),document.getElementById("lineBtn").classList.add("active"),console.log("Modo de desenho ativado (Ctrl+D)"),C.trackDraw()),z()}function te(){A?(A=!1,console.log("Modo shadow desativado (Ctrl+S)")):(A=!0,v=!1,h=null,l.style.pointerEvents="none",E("toggleShadowBtn"),console.log("Modo shadow ativado (Ctrl+S)")),z()}function de(){a.clearRect(0,0,l.width,l.height),y=[],R=[],console.log("Tudo limpo: desenhos e shadows (Ctrl+Shift+C)")}function ie(t){alert({pt:{shadowBlocked:`⚠️ Você está com desenho ativo!

Desative o desenho primeiro ou use Ctrl+S para ativar sombra automaticamente.`,drawBlocked:`⚠️ Você está com sombra ativa!

Desative a sombra primeiro ou use Ctrl+D para ativar desenho automaticamente.`},en:{shadowBlocked:`⚠️ You have drawing active!

Disable drawing first or use Ctrl+S to activate shadow automatically.`,drawBlocked:`⚠️ You have shadow active!

Disable shadow first or use Ctrl+D to activate drawing automatically.`},tr:{shadowBlocked:`⚠️ Çizim aktif!

Önce çizimi devre dışı bırakın veya gölgeyi otomatik olarak etkinleştirmek için Ctrl+S kullanın.`,drawBlocked:`⚠️ Gölge aktif!

Önce gölgeyi devre dışı bırakın veya çizimi otomatik olarak etkinleştirmek için Ctrl+D kullanın.`},es:{shadowBlocked:`⚠️ ¡Tienes dibujo activo!

Desactiva el dibujo primero o usa Ctrl+S para activar sombra automáticamente.`,drawBlocked:`⚠️ ¡Tienes sombra activa!

Desactiva la sombra primero o usa Ctrl+D para activar dibujo automáticamente.`}}[s][t])}function E(t){document.querySelectorAll(".shape-menu button, #drawOnBtn, #eraseBtn, #drawOffBtn").forEach(e=>{e.classList.remove("active")}),t&&document.getElementById(t).classList.add("active")}document.getElementById("redFormationSelect").addEventListener("change",()=>{b==="11x11"&&Z(b,B)});document.getElementById("blueFormationSelect").addEventListener("change",()=>{b==="11x11"&&Z(b,B)});class ce{constructor(){this.currentTab="tactical",this.initTabs()}initTabs(){const e=document.querySelectorAll(".tab");document.querySelectorAll(".tab-content"),e.forEach(i=>{i.addEventListener("click",()=>{const o=i.dataset.tab;this.switchTab(o)})})}switchTab(e){switch(document.querySelectorAll(".tab").forEach(i=>i.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(i=>i.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}-tab`).classList.add("active"),this.currentTab=e,e){case"replay":this.replayInitialized||(this.initReplayPlayer(),this.replayInitialized=!0);break;case"stream":break;case"videos":!this.videosInitialized&&window.contentManager&&(window.contentManager.loadPublicVideos(),this.videosInitialized=!0);break;case"tutorials":!this.tutorialsInitialized&&window.contentManager&&(window.contentManager.loadPublicTutorials(),this.tutorialsInitialized=!0);break}}initReplayPlayer(){new ue().init()}}class ue{constructor(){this.replay=null,this.isPlaying=!1,this.currentTime=0,this.duration=0,this.players=[],this.canvas=null,this.ctx=null,this.drawCanvas=null,this.drawCtx=null,this.animationFrame=null}init(){this.setupCanvas(),this.setupEventListeners()}setupCanvas(){this.canvas=document.getElementById("replayCanvas"),this.ctx=this.canvas?.getContext("2d"),this.drawCanvas=document.getElementById("replayDrawLayer"),this.drawCtx=this.drawCanvas?.getContext("2d"),this.canvas&&this.drawCanvas&&(this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas()))}resizeCanvas(){const i=this.canvas.parentElement.getBoundingClientRect();[this.canvas,this.drawCanvas].forEach(o=>{o.width=i.width,o.height=i.height})}setupEventListeners(){const e=document.getElementById("hbr2FileInput"),i=document.getElementById("selectFileBtn"),o=document.getElementById("uploadArea");i?.addEventListener("click",()=>e?.click()),e?.addEventListener("change",r=>{r.target.files[0]&&this.loadReplay(r.target.files[0])}),o?.addEventListener("dragover",r=>{r.preventDefault(),o.classList.add("dragover")}),o?.addEventListener("dragleave",()=>{o.classList.remove("dragover")}),o?.addEventListener("drop",r=>{r.preventDefault(),o.classList.remove("dragover"),r.dataTransfer.files[0]&&this.loadReplay(r.dataTransfer.files[0])}),document.getElementById("playPauseBtn")?.addEventListener("click",()=>this.togglePlayPause()),document.getElementById("stopBtn")?.addEventListener("click",()=>this.stop()),document.getElementById("timelineSlider")?.addEventListener("input",r=>{this.seekTo(parseFloat(r.target.value))}),document.getElementById("replayDrawBtn")?.addEventListener("click",()=>this.setDrawMode("draw")),document.getElementById("replayEraseBtn")?.addEventListener("click",()=>this.setDrawMode("erase")),document.getElementById("replayClearBtn")?.addEventListener("click",()=>this.clearDrawings()),document.getElementById("newReplayBtn")?.addEventListener("click",()=>this.newReplay())}newReplay(){this.stop(),this.replay=null,this.currentTime=0,this.duration=0,this.clearDrawings(),document.getElementById("uploadArea").style.display="block",document.getElementById("replayPlayer").style.display="none",document.getElementById("fileInput").value="";const e=document.getElementById("timelineEvents");e&&(e.innerHTML="")}async loadReplay(e){try{console.log("Carregando arquivo:",e.name);const i=await e.arrayBuffer();this.replay=await this.parseHBR2(i),this.replay&&(console.log("Replay carregado com sucesso:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration||300,this.currentTime=0,this.updateUI(),this.render())}catch(i){console.error("Erro ao carregar replay:",i),this.createDemoReplay()}}createDemoReplay(){this.replay={version:1,duration:300,players:[{id:1,name:"Player 1",team:1,color:16729156},{id:2,name:"Player 2",team:1,color:16729156},{id:3,name:"Player 3",team:1,color:16729156},{id:4,name:"Player 4",team:2,color:4474111},{id:5,name:"Player 5",team:2,color:4474111},{id:6,name:"Player 6",team:2,color:4474111}],events:[{type:"goal",time:45.5,player:"Player 1",team:1},{type:"goal",time:120.3,player:"Player 4",team:2},{type:"goal",time:180.7,player:"Player 2",team:1},{type:"goal",time:250.1,player:"Player 5",team:2}],stadium:{name:"Clássico",width:800,height:400}},console.log("Replay demo criado:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration,this.currentTime=0,this.updateUI(),this.render()}async parseHBR2(e){try{console.log("Tentando fazer parse do HBR2, tamanho:",e.byteLength);const i=new DataView(e),o=new TextDecoder;if(e.byteLength<16)throw new Error("Arquivo muito pequeno para ser um HBR2 válido");let n=0;const r=i.getUint32(n,!0);n+=4,console.log("Versão detectada:",r);const d={version:r,duration:0,players:[],events:[],frames:[],stadium:null};return console.log("Estrutura básica do HBR2 detectada"),d}catch(i){throw console.error("Erro no parser HBR2:",i),i}}displayReplayInfo(){if(!this.replay)return;const e=this.replay.players?this.replay.players.length:0,i=this.replay.events?this.replay.events.filter(o=>o.type==="goal").length:0;document.getElementById("replayTitle").textContent=`Replay Carregado - ${i} gols`,document.getElementById("replayDuration").textContent=`Duração: ${this.formatTime(this.replay.duration)}`,document.getElementById("replayPlayers").textContent=`Jogadores: ${e}`,document.getElementById("replayMap").textContent=`Mapa: ${this.replay.stadium?.name||"Clássico"}`}showPlayer(){document.getElementById("uploadArea").style.display="none",document.getElementById("replayPlayer").style.display="block"}togglePlayPause(){this.isPlaying=!this.isPlaying;const e=document.getElementById("playPauseBtn");this.isPlaying?(e.textContent="⏸️ Pause",this.play()):(e.textContent="▶️ Play",this.pause())}play(){if(!this.replay)return;const e=()=>{this.isPlaying&&this.currentTime<this.duration?(this.currentTime+=1/60,this.render(),this.updateUI(),this.animationFrame=requestAnimationFrame(e)):this.currentTime>=this.duration&&this.stop()};e()}pause(){this.animationFrame&&cancelAnimationFrame(this.animationFrame)}stop(){this.isPlaying=!1,this.currentTime=0,this.pause(),document.getElementById("playPauseBtn").textContent="▶️ Play",this.updateUI()}seekTo(e){this.currentTime=e/100*this.duration,this.render(),this.updateUI()}render(){!this.ctx||!this.replay||(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawField(),this.drawPlayers(),this.drawTimelineEvents())}drawField(){const e=this.canvas.width,i=this.canvas.height;this.ctx.fillStyle="#4a7c59",this.ctx.fillRect(0,0,e,i),this.ctx.strokeStyle="white",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.rect(40,40,e-80,i-80),this.ctx.moveTo(e/2,40),this.ctx.lineTo(e/2,i-40),this.ctx.arc(e/2,i/2,60,0,Math.PI*2),this.ctx.moveTo(e/2+60,i/2);const o=120,n=80,r=(i-n)/2;this.ctx.rect(40,r,o,n),this.ctx.rect(e-40-o,r,o,n);const d=8,p=40,u=(i-p)/2;this.ctx.rect(40-d,u,d,p),this.ctx.rect(e-40,u,d,p),this.ctx.stroke()}drawPlayers(){if(!this.replay.players)return;this.replay.players.forEach((o,n)=>{const r=100+n%3*200,d=100+Math.floor(n/3)*100,p=r+Math.sin(this.currentTime*.5+n)*50,u=d+Math.cos(this.currentTime*.3+n)*30;this.ctx.beginPath(),this.ctx.arc(p,u,18,0,Math.PI*2),this.ctx.fillStyle=o.team===1?"#ff4444":"#4444ff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 11px Arial",this.ctx.textAlign="center",this.ctx.fillText(o.name,p,u+3)});const e=this.canvas.width/2+Math.sin(this.currentTime)*100,i=this.canvas.height/2+Math.cos(this.currentTime*1.2)*50;this.ctx.beginPath(),this.ctx.arc(e,i,8,0,Math.PI*2),this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke()}drawTimelineEvents(){if(!this.replay.events)return;const e=document.getElementById("timelineEvents");e&&(e.innerHTML="",this.replay.events.forEach(i=>{const o=document.createElement("div");o.className=`timeline-event ${i.type}`,o.style.left=`${i.time/this.duration*100}%`,o.title=`${i.type.toUpperCase()}: ${i.player} (${this.formatTime(i.time)})`,o.addEventListener("click",()=>{this.currentTime=i.time,this.updateUI(),this.render()}),e.appendChild(o)}))}updateUI(){const e=document.getElementById("timelineSlider"),i=document.getElementById("timeDisplay");e&&(e.value=this.currentTime/this.duration*100||0),i&&(i.textContent=`${this.formatTime(this.currentTime)} / ${this.formatTime(this.duration)}`)}formatTime(e){const i=Math.floor(e/60),o=Math.floor(e%60);return`${i.toString().padStart(2,"0")}:${o.toString().padStart(2,"0")}`}setDrawMode(e){this.drawMode=e,document.querySelectorAll(".replay-toolbar button").forEach(i=>i.classList.remove("active")),e==="draw"?(document.getElementById("replayDrawBtn").classList.add("active"),this.drawCanvas.style.cursor="crosshair"):e==="erase"?(document.getElementById("replayEraseBtn").classList.add("active"),this.drawCanvas.style.cursor="grab"):this.drawCanvas.style.cursor="default",e==="draw"&&this.setupDrawingEvents()}setupDrawingEvents(){let e=!1,i=0,o=0;this.drawCanvas.onmousedown=n=>{e=!0,[i,o]=[n.offsetX,n.offsetY],n.button===0?this.drawCtx.strokeStyle=document.getElementById("leftClickColor").value:n.button===2&&(this.drawCtx.strokeStyle=document.getElementById("rightClickColor").value,n.preventDefault()),this.drawCtx.lineWidth=document.getElementById("brushSize").value,this.drawCtx.lineCap="round"},this.drawCanvas.onmousemove=n=>{e&&(this.drawCtx.beginPath(),this.drawCtx.moveTo(i,o),this.drawCtx.lineTo(n.offsetX,n.offsetY),this.drawCtx.stroke(),[i,o]=[n.offsetX,n.offsetY])},this.drawCanvas.onmouseup=()=>{e=!1},this.drawCanvas.oncontextmenu=n=>{n.preventDefault()}}clearDrawings(){this.drawCtx&&this.drawCtx.clearRect(0,0,this.drawCanvas.width,this.drawCanvas.height)}}document.addEventListener("DOMContentLoaded",()=>{new ce});document.getElementById("drawOnBtn").onclick=()=>{if(A){ie("drawBlocked");return}ee()};document.getElementById("drawOffBtn").onclick=()=>{v=!1,h=null,l.style.pointerEvents="none",E("drawOffBtn")};document.getElementById("eraseBtn").onclick=()=>{A=!1,v=!0,h=null,l.style.pointerEvents="auto",E("eraseBtn"),z()};document.getElementById("clearBtn").onclick=()=>{a.clearRect(0,0,l.width,l.height),y=[],R=[]};document.getElementById("freeBtn").onclick=()=>{v=!1,h="free",l.style.pointerEvents="auto",E("freeBtn")};document.getElementById("lineBtn").onclick=()=>{v=!1,h="line",l.style.pointerEvents="auto",E("lineBtn")};document.getElementById("squareBtn").onclick=()=>{v=!1,h="square",l.style.pointerEvents="auto",E("squareBtn")};document.getElementById("triangleBtn").onclick=()=>{v=!1,h="triangle",l.style.pointerEvents="auto",E("triangleBtn")};document.getElementById("circleBtn").onclick=()=>{v=!1,h="circle",l.style.pointerEvents="auto",E("circleBtn")};document.getElementById("arrowBtn").onclick=()=>{v=!1,h="arrow",l.style.pointerEvents="auto",E("arrowBtn")};document.getElementById("primaryColorPicker").addEventListener("change",t=>{q=t.target.value});document.getElementById("secondaryColorPicker").addEventListener("change",t=>{H=t.target.value});document.getElementById("redShadowColorPicker").addEventListener("change",t=>{F=t.target.value});document.getElementById("blueShadowColorPicker").addEventListener("change",t=>{Y=t.target.value});document.getElementById("tipsBtn").onclick=()=>{alert({pt:`💡 DICAS:

• Ctrl+Z: Desfazer última ação
• Ctrl+D: Ativar/Desativar modo desenho
• Ctrl+S: Ativar/Desativar modo shadow
• Ctrl+L: Limpar tudo (desenhos + shadows)
• Botão Esquerdo: Desenhar com cor primária
• Botão Direito: Desenhar com cor secundária
• Ative sombra e segure o jogador com botão direito e arraste para criar um rastro de movimento`,en:`💡 TIPS:

• Ctrl+Z: Undo last action
• Ctrl+D: Toggle draw mode
• Ctrl+S: Toggle shadow mode
• Ctrl+L: Clear everything (drawings + shadows)
• Left Click: Draw with primary color
• Right Click: Draw with secondary color
• Activate shadow and hold the player with right mouse button and drag to create a movement trail`,tr:`💡 İPUÇLARI:

• Ctrl+Z: Son işlemi geri al
• Ctrl+D: Çizim modunu aç/kapat
• Ctrl+S: Gölge modunu aç/kapat
• Ctrl+L: Her şeyi temizle (çizimler + gölgeler)
• Sol Tık: Birincil renkle çiz
• Sağ Tık: İkincil renkle çiz
• Gölgeyi etkinleştirip oyuncuya sağ tıkla ve sürükle, hareket izi oluştur`,es:`💡 CONSEJOS:

• Ctrl+Z: Deshacer última acción
• Ctrl+D: Activar/Desactivar modo dibujo
• Ctrl+S: Activar/Desactivar modo sombra
• Ctrl+L: Limpiar todo (dibujos + sombras)
• Clic Izquierdo: Dibujar con color primario
• Clic Derecho: Dibujar con color secundario
• Activa sombra y mantén el jugador con botón derecho y arrastra para crear una estela de movimiento`}[s])};document.getElementById("toggleShadowBtn").onclick=()=>{if(h!==null&&!v){ie("shadowBlocked");return}te()};document.getElementById("downloadBtn").onclick=()=>{C.trackDownload();const t=document.createElement("canvas");t.width=x.clientWidth,t.height=x.clientHeight;const e=t.getContext("2d"),i=new Image;i.crossOrigin="anonymous",i.onload=()=>{e.drawImage(i,0,0,t.width,t.height),e.drawImage(l,0,0);let n=0;const r=k.length;if(r===0){U(t);return}k.forEach(d=>{const p=new Image;p.onload=()=>{const u=d.size||29,w=document.createElement("canvas");w.width=u,w.height=u;const f=w.getContext("2d");f.beginPath(),f.arc(u/2,u/2,u/2-2,0,Math.PI*2),f.fillStyle=getComputedStyle(d.el).backgroundColor,f.fill(),f.strokeStyle=getComputedStyle(d.el).borderColor,f.lineWidth=2,f.stroke(),d.id&&(f.font=`bold ${Math.max(10,u*.4)}px Arial, sans-serif`,f.fillStyle=getComputedStyle(d.el).color,f.textAlign="center",f.textBaseline="middle",f.fillText(d.el.textContent,u/2,u/2));const D=x.getBoundingClientRect(),G=d.x*D.width-u/2,ae=d.y*D.height-u/2;e.drawImage(w,G,ae),n++,n===r&&U(t)},p.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};const o=I[b][B];i.src=o.backgroundImage};function U(t){const e=document.createElement("a");e.download=`quadro-tatico-${b}-${B}.png`,e.href=t.toDataURL("image/png"),e.click()}class me{constructor(){this.adminPassword="admin123",this.videos=JSON.parse(localStorage.getItem("videos")||"[]"),this.tutorials=JSON.parse(localStorage.getItem("tutorials")||"[]"),this.initContent()}initContent(){this.loadPublicVideos(),this.loadPublicTutorials()}authenticateVideos(){document.getElementById("videosPassword").value===this.adminPassword?(document.getElementById("videosLoginForm").style.display="none",document.getElementById("videosAdminPanel").style.display="block",this.loadAdminVideos()):alert("Senha incorreta!")}authenticateTutorials(){document.getElementById("tutorialsPassword").value===this.adminPassword?(document.getElementById("tutorialsLoginForm").style.display="none",document.getElementById("tutorialsAdminPanel").style.display="block",this.loadAdminTutorials()):alert("Senha incorreta!")}addVideo(){const e=document.getElementById("videoTitle").value,i=document.getElementById("videoUrl").value;if(!e||!i){alert("Preencha todos os campos!");return}const o=this.extractYouTubeId(i);if(!o){alert("URL do YouTube inválida!");return}const n={id:Date.now(),title:e,url:i,videoId:o,embedUrl:`https://www.youtube.com/embed/${o}`,createdAt:new Date().toLocaleDateString()};this.videos.push(n),localStorage.setItem("videos",JSON.stringify(this.videos)),document.getElementById("videoTitle").value="",document.getElementById("videoUrl").value="",this.loadAdminVideos(),this.loadPublicVideos()}extractYouTubeId(e){const i=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/,o=e.match(i);return o?o[1]:null}removeVideo(e){this.videos=this.videos.filter(i=>i.id!==e),localStorage.setItem("videos",JSON.stringify(this.videos)),this.loadAdminVideos(),this.loadPublicVideos()}loadAdminVideos(){const e=document.getElementById("videosList");e.innerHTML=this.videos.map(i=>`
      <div class="content-item">
        <h3>${i.title}</h3>
        <iframe width="100%" height="200" src="${i.embedUrl}" frameborder="0" allowfullscreen></iframe>
        <p>Adicionado em: ${i.createdAt}</p>
        <button onclick="contentManager.removeVideo(${i.id})" style="background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px;">Remover</button>
      </div>
    `).join("")}loadPublicVideos(){const e=document.getElementById("publicVideosList");if(this.videos.length===0){e.innerHTML='<p style="text-align: center; color: #aaa;">Nenhum vídeo disponível no momento.</p>';return}e.innerHTML=this.videos.map(i=>`
      <div class="content-item">
        <h3>${i.title}</h3>
        <iframe width="100%" height="200" src="${i.embedUrl}" frameborder="0" allowfullscreen></iframe>
        <p>Publicado em: ${i.createdAt}</p>
      </div>
    `).join("")}addTutorial(){const e=document.getElementById("tutorialTitle").value,i=document.getElementById("tutorialContent").value;if(!e||!i){alert("Preencha todos os campos!");return}const o={id:Date.now(),title:e,content:i,createdAt:new Date().toLocaleDateString()};this.tutorials.push(o),localStorage.setItem("tutorials",JSON.stringify(this.tutorials)),document.getElementById("tutorialTitle").value="",document.getElementById("tutorialContent").value="",this.loadAdminTutorials(),this.loadPublicTutorials()}removeTutorial(e){this.tutorials=this.tutorials.filter(i=>i.id!==e),localStorage.setItem("tutorials",JSON.stringify(this.tutorials)),this.loadAdminTutorials(),this.loadPublicTutorials()}loadAdminTutorials(){const e=document.getElementById("tutorialsList");e.innerHTML=this.tutorials.map(i=>`
      <div class="content-item">
        <h3>${i.title}</h3>
        <div>${i.content}</div>
        <p>Adicionado em: ${i.createdAt}</p>
        <button onclick="contentManager.removeTutorial(${i.id})" style="background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px;">Remover</button>
      </div>
    `).join("")}loadPublicTutorials(){const e=document.getElementById("publicTutorialsList");if(this.tutorials.length===0){e.innerHTML='<p style="text-align: center; color: #aaa;">Nenhum tutorial disponível no momento.</p>';return}e.innerHTML=this.tutorials.map(i=>`
      <div class="content-item">
        <h3>${i.title}</h3>
        <div>${i.content}</div>
        <p>Publicado em: ${i.createdAt}</p>
      </div>
    `).join("")}}let X;document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("drawOffBtn");t&&t.click(),J(),z(),l&&x&&N(),X=new me,window.contentManager=X,setTimeout(()=>{C.trackVisit()},100)});
