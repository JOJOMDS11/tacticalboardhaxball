(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))o(r);new MutationObserver(r=>{for(const u of r)if(u.type==="childList")for(const d of u.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&o(d)}).observe(document,{childList:!0,subtree:!0});function a(r){const u={};return r.integrity&&(u.integrity=r.integrity),r.referrerPolicy&&(u.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?u.credentials="include":r.crossOrigin==="anonymous"?u.credentials="omit":u.credentials="same-origin",u}function o(r){if(r.ep)return;r.ep=!0;const u=a(r);fetch(r.href,u)}})();const P={apiKey:void 0,authDomain:void 0,databaseURL:void 0,projectId:void 0,storageBucket:void 0,messagingSenderId:void 0,appId:void 0};class q{constructor(){this.firebaseInitialized=!1;try{Object.values(P).every(e=>e)?(firebase.apps.length||firebase.initializeApp(P),this.db=firebase.database(),this.firebaseInitialized=!0,console.log("Firebase inicializado com sucesso")):console.warn("Configuração do Firebase incompleta. As estatísticas não serão rastreadas.")}catch(e){console.error("Erro ao inicializar Firebase:",e)}this.counters={totalVisits:"totalVisits",todayVisits:"todayVisits_"+new Date().toISOString().split("T")[0],downloads:"downloads",drawActivations:"drawActivations",languageChanges:"languageChanges",discordClicks:"discordClicks",configChanges:"configChanges",langPt:"langPt",langEn:"langEn",langTr:"langTr",langEs:"langEs"}}async increment(e,a=1){if(!this.firebaseInitialized)return 0;try{return await this.db.ref(`stats/${e}`).transaction(r=>(r||0)+a),(await this.db.ref(`stats/${e}`).once("value")).val()||0}catch(o){return console.error("Erro Firebase increment:",o),0}}async trackVisit(){try{await this.increment(this.counters.totalVisits),await this.increment(this.counters.todayVisits),console.log("Visita rastreada com sucesso")}catch(e){console.error("Erro ao rastrear visita:",e)}}async trackDownload(){try{await this.increment(this.counters.downloads),console.log("Download rastreado com sucesso")}catch(e){console.error("Erro ao rastrear download:",e)}}async trackDraw(){try{await this.increment(this.counters.drawActivations),console.log("Ativação de desenho rastreada com sucesso")}catch(e){console.error("Erro ao rastrear ativação de desenho:",e)}}async trackLanguageChange(e){try{await this.increment(this.counters.languageChanges),e==="pt"&&await this.increment(this.counters.langPt),e==="en"&&await this.increment(this.counters.langEn),e==="tr"&&await this.increment(this.counters.langTr),e==="es"&&await this.increment(this.counters.langEs),console.log(`Mudança de idioma para ${e} rastreada com sucesso`)}catch(a){console.error("Erro ao rastrear mudança de idioma:",a)}}async trackDiscordClick(){try{await this.increment(this.counters.discordClicks),console.log("Clique no Discord rastreado com sucesso")}catch(e){console.error("Erro ao rastrear clique no Discord:",e)}}async trackConfigChange(e,a){try{await this.increment(this.counters.configChanges),await this.increment(`${e}_${a}`),console.log(`Configuração ${e} alterada para ${a}`)}catch(o){console.error("Erro ao rastrear mudança de configuração:",o)}}}const p=new q,E=document.getElementById("board"),l=document.getElementById("drawLayer"),S=document.getElementById("players"),n=l.getContext("2d");let m="line",x=!1,y=!1,B=null,s=null,g=[];const V=10;let i="pt",L="3x3",C="futsal";const A={"3x3":{futsal:{backgroundImage:"https://i.imgur.com/UiOK7Gr.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5},{uid:2,id:"VL",team:"red",x:.25,y:.25},{uid:3,id:"PV",team:"red",x:.25,y:.75},{uid:4,id:"GK",team:"blue",x:.9,y:.5},{uid:5,id:"VL",team:"blue",x:.75,y:.25},{uid:6,id:"PV",team:"blue",x:.75,y:.75},{uid:10,id:"",team:"ball",x:.5,y:.5}]}},"4x4":{futsal:{backgroundImage:"https://i.imgur.com/UiOK7Gr.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5},{uid:2,id:"DEF",team:"red",x:.3,y:.3},{uid:3,id:"MID",team:"red",x:.3,y:.7},{uid:4,id:"ATT",team:"red",x:.45,y:.5},{uid:5,id:"GK",team:"blue",x:.9,y:.5},{uid:6,id:"DEF",team:"blue",x:.7,y:.3},{uid:7,id:"MID",team:"blue",x:.7,y:.7},{uid:8,id:"ATT",team:"blue",x:.55,y:.5},{uid:10,id:"",team:"ball",x:.5,y:.5}]}}};let I=A[L][C].players;const c={pt:{drawOnBtn:"Ativar Desenho",drawOffBtn:"Desativar Desenho",eraseBtn:"Borracha",clearBtn:"Limpar",colorLabel:"Cor:",downloadBtn:"Baixar PNG",freeBtn:"Livre",lineBtn:"Linha",squareBtn:"Quadrado",triangleBtn:"Triângulo",circleBtn:"Círculo",arrowBtn:"Seta",strokeSizeLabel:"Tamanho do Traço:",eraserSizeLabel:"Tamanho da Borracha:",discordMessage:"ENTRE AGORA MESMO EM NOSSO DISCORD PARA PARTICAR DOS EVENTOS.",creditsLabel:"Feito por:",helpProject:"Ajude o projeto",teamSizeLabel:"Tamanho do Time:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal"},en:{drawOnBtn:"Activate Draw",drawOffBtn:"Deactivate Draw",eraseBtn:"Eraser",clearBtn:"Clear",colorLabel:"Color:",downloadBtn:"Download PNG",freeBtn:"Free",lineBtn:"Line",squareBtn:"Square",triangleBtn:"Triangle",circleBtn:"Circle",arrowBtn:"Arrow",strokeSizeLabel:"Stroke Size:",eraserSizeLabel:"Eraser Size:",discordMessage:"JOIN OUR DISCORD NOW TO PARTICIPATE IN EVENTS.",creditsLabel:"Made by:",helpProject:"Help the project",teamSizeLabel:"Team Size:",mapTypeLabel:"Map Type:",currentModeLabel:"— 3x3 Futsal"},tr:{drawOnBtn:"Çizimi Etkinleştir",drawOffBtn:"Çizimi Devre Dışı Bırak",eraseBtn:"Silgi",clearBtn:"Temizle",colorLabel:"Renk:",downloadBtn:"PNG İndir",freeBtn:"Serbest",lineBtn:"Çizgi",squareBtn:"Kare",triangleBtn:"Üçgen",circleBtn:"Çember",arrowBtn:"Ok",strokeSizeLabel:"Çizgi Kalınlığı:",eraserSizeLabel:"Silgi Boyutu:",discordMessage:"ETKİNLİKLERE KATILMAK İÇİN DISCORD'UMUZA HEMEN KATILIN.",creditsLabel:"Yapılan:",helpProject:"Projeye yardım et",teamSizeLabel:"Takım Boyutu:",mapTypeLabel:"Harita Tipi:",currentModeLabel:"— 3x3 Futsal"},es:{drawOnBtn:"Activar Dibujo",drawOffBtn:"Desactivar Dibujo",eraseBtn:"Goma",clearBtn:"Limpiar",colorLabel:"Color:",downloadBtn:"Descargar PNG",freeBtn:"Libre",lineBtn:"Línea",squareBtn:"Cuadrado",triangleBtn:"Triángulo",circleBtn:"Círculo",arrowBtn:"Flecha",strokeSizeLabel:"Grosor del Trazo:",eraserSizeLabel:"Tamaño de la Goma:",discordMessage:"ÚNETE A NUESTRO DISCORD AHORA PARA PARTICIPAR EN LOS EVENTOS.",creditsLabel:"Hecho por:",helpProject:"Ayuda al proyecto",teamSizeLabel:"Tamaño del Equipo:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal"}};function v(){document.getElementById("drawOnBtn").textContent=c[i].drawOnBtn,document.getElementById("drawOffBtn").textContent=c[i].drawOffBtn,document.getElementById("eraseBtn").textContent=c[i].eraseBtn,document.getElementById("clearBtn").textContent=c[i].clearBtn,document.getElementById("colorLabel").textContent=c[i].colorLabel,document.getElementById("downloadBtn").textContent=c[i].downloadBtn,document.getElementById("freeBtn").textContent=c[i].freeBtn,document.getElementById("lineBtn").textContent=c[i].lineBtn,document.getElementById("squareBtn").textContent=c[i].squareBtn,document.getElementById("triangleBtn").textContent=c[i].triangleBtn,document.getElementById("circleBtn").textContent=c[i].circleBtn,document.getElementById("arrowBtn").textContent=c[i].arrowBtn,document.getElementById("strokeSizeLabel").textContent=c[i].strokeSizeLabel,document.getElementById("eraserSizeLabel").textContent=c[i].eraserSizeLabel,document.querySelector(".discord-message a").textContent=c[i].discordMessage,document.getElementById("creditsLabel").textContent=c[i].creditsLabel,document.getElementById("helpProjectLabel").textContent=c[i].helpProject,document.getElementById("teamSizeLabel").textContent=c[i].teamSizeLabel,document.getElementById("mapTypeLabel").textContent=c[i].mapTypeLabel,document.getElementById("currentModeLabel").textContent=c[i].currentModeLabel,document.querySelectorAll(".language-selector img").forEach(t=>{t.classList.remove("active")}),document.getElementById(`flag-${i}`).classList.add("active")}document.getElementById("flag-pt").addEventListener("click",()=>{i="pt",v(),p.trackLanguageChange("pt")});document.getElementById("flag-en").addEventListener("click",()=>{i="en",v(),p.trackLanguageChange("en")});document.getElementById("flag-tr").addEventListener("click",()=>{i="tr",v(),p.trackLanguageChange("tr")});document.getElementById("flag-es").addEventListener("click",()=>{i="es",v(),p.trackLanguageChange("es")});document.getElementById("teamSizeSelect").addEventListener("change",t=>{t.target.value==="3x3"?(D(t.target.value,C),p.trackConfigChange("team_size",t.target.value)):(t.target.value="3x3",alert(i==="pt"?"Esta opção estará disponível em breve!":i==="en"?"This option will be available soon!":"Bu seçenek yakında kullanılabilir olacak!"))});document.getElementById("mapTypeSelect").addEventListener("change",t=>{t.target.value==="futsal"?(D(L,t.target.value),p.trackConfigChange("map_type",t.target.value)):(t.target.value="futsal",alert(i==="pt"?"Este mapa estará disponível em breve!":i==="en"?"This map will be available soon!":"Bu harita yakında kullanılabilir olacak!"))});function D(t,e){L=t,C=e,S.innerHTML="";const a=A[t][e];I=a.players,E.style.backgroundImage=`url('${a.backgroundImage}')`,I.forEach(o=>{const r=document.createElement("div");r.className=`player ${o.team}`,r.textContent=o.id,r.dataset.uid=o.uid,S.appendChild(r),o.el=r}),T(),n.clearRect(0,0,l.width,l.height),g=[]}document.querySelector(".discord-message a").addEventListener("click",()=>{p.trackDiscordClick()});function F(){g.length>=V&&g.shift(),g.push(l.toDataURL())}function G(){if(g.length>0)if(g.pop(),g.length>0){const t=new Image;t.onload=()=>{n.clearRect(0,0,l.width,l.height),n.drawImage(t,0,0)},t.src=g[g.length-1]}else n.clearRect(0,0,l.width,l.height)}function M(){if(l.width=E.clientWidth,l.height=E.clientHeight,g.length>0){const t=new Image;t.onload=()=>{n.drawImage(t,0,0)},t.src=g[g.length-1]}}window.addEventListener("resize",M);M();I.forEach(t=>{const e=document.createElement("div");e.className=`player ${t.team}`,e.textContent=t.id,e.dataset.uid=t.uid,S.appendChild(e),t.el=e});function T(){const t=E.getBoundingClientRect();I.forEach(e=>{const a=parseInt(getComputedStyle(e.el).getPropertyValue("--size"),10);e.el.style.left=e.x*t.width-a/2+"px",e.el.style.top=e.y*t.height-a/2+"px"})}T();window.addEventListener("resize",T);let h=null;E.addEventListener("pointerdown",t=>{const e=t.target.closest(".player");if(!e)return;const a=E.getBoundingClientRect(),o=e.dataset.uid,r=I.find(u=>u.uid==o);r&&(parseInt(getComputedStyle(e).getPropertyValue("--size"),10),h={p:r,offsetX:t.clientX-a.left-r.x*a.width,offsetY:t.clientY-a.top-r.y*a.height},e.setPointerCapture(t.pointerId))});window.addEventListener("pointermove",t=>{if(!h)return;const e=E.getBoundingClientRect(),a=parseInt(getComputedStyle(h.p.el).getPropertyValue("--size"),10);h.p.x=(t.clientX-e.left-h.offsetX)/e.width,h.p.y=(t.clientY-e.top-h.offsetY)/e.height;const o=a/2/e.width,r=1-a/2/e.width,u=a/2/e.height,d=1-a/2/e.height;h.p.x=Math.max(o,Math.min(h.p.x,r)),h.p.y=Math.max(u,Math.min(h.p.y,d)),T()});window.addEventListener("pointerup",()=>{h=null});function b(t){const e=l.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function R(t){const e=b(t);if(n.clearRect(0,0,l.width,l.height),g.length>0){const a=new Image;a.src=g[g.length-1],n.drawImage(a,0,0)}if(n.strokeStyle=document.getElementById("colorPicker").value,n.lineWidth=document.getElementById("sizePicker").value,n.lineCap="round",n.beginPath(),m==="line")n.moveTo(s.x,s.y),n.lineTo(e.x,e.y),n.stroke();else if(m==="square"){const a=e.x-s.x,o=e.y-s.y;n.strokeRect(s.x,s.y,a,o)}else if(m==="triangle")n.moveTo(s.x,s.y),n.lineTo(e.x,e.y),n.lineTo(s.x+(e.x-s.x)/2,s.y),n.closePath(),n.stroke();else if(m==="circle"){const a=e.x-s.x,o=e.y-s.y,r=Math.sqrt(a*a+o*o)/2;n.arc(s.x+a/2,s.y+o/2,r,0,2*Math.PI),n.stroke()}else if(m==="arrow"){const o=Math.atan2(e.y-s.y,e.x-s.x);n.moveTo(s.x,s.y),n.lineTo(e.x,e.y),n.stroke(),n.beginPath(),n.moveTo(e.x,e.y),n.lineTo(e.x-15*Math.cos(o-Math.PI/6),e.y-15*Math.sin(o-Math.PI/6)),n.lineTo(e.x-15*Math.cos(o+Math.PI/6),e.y-15*Math.sin(o+Math.PI/6)),n.closePath(),n.fillStyle=n.strokeStyle,n.fill()}}function K(t){if(y){x=!0,B=b(t);return}m!==null&&(x=!0,m==="free"?(B=b(t),n.strokeStyle=document.getElementById("colorPicker").value,n.lineWidth=document.getElementById("sizePicker").value,n.lineCap="round",n.beginPath(),n.moveTo(B.x,B.y)):(s=b(t),B=b(t)))}function j(t){if(x)if(y){const e=b(t);n.lineWidth=document.getElementById("eraserSizePicker").value,n.lineCap="round",n.globalCompositeOperation="destination-out",n.beginPath(),n.moveTo(B.x,B.y),n.lineTo(e.x,e.y),n.stroke(),B=e}else if(m==="free"){const e=b(t);n.globalCompositeOperation="source-over",n.lineTo(e.x,e.y),n.stroke(),B=e}else R(t)}function N(){x&&(y||(m==="free"||R(event),F()),x=!1,B=null,s=null,n.globalCompositeOperation="source-over")}l.addEventListener("mousedown",K);l.addEventListener("mousemove",j);window.addEventListener("mouseup",N);l.addEventListener("mouseleave",N);window.addEventListener("keydown",t=>{t.ctrlKey&&t.key==="z"&&(t.preventDefault(),G())});function w(t){document.querySelectorAll(".shape-menu button, #drawOnBtn, #eraseBtn, #drawOffBtn").forEach(e=>{e.classList.remove("active")}),t&&document.getElementById(t).classList.add("active")}document.getElementById("drawOnBtn").onclick=()=>{y=!1,m="line",l.style.pointerEvents="auto",w("drawOnBtn"),document.getElementById("lineBtn").classList.add("active"),p.trackDraw()};document.getElementById("drawOffBtn").onclick=()=>{y=!1,m=null,l.style.pointerEvents="none",w("drawOffBtn")};document.getElementById("eraseBtn").onclick=()=>{y=!0,m=null,l.style.pointerEvents="auto",w("eraseBtn")};document.getElementById("clearBtn").onclick=()=>{n.clearRect(0,0,l.width,l.height),g=[]};document.getElementById("freeBtn").onclick=()=>{y=!1,m="free",l.style.pointerEvents="auto",w("freeBtn")};document.getElementById("lineBtn").onclick=()=>{y=!1,m="line",l.style.pointerEvents="auto",w("lineBtn")};document.getElementById("squareBtn").onclick=()=>{y=!1,m="square",l.style.pointerEvents="auto",w("squareBtn")};document.getElementById("triangleBtn").onclick=()=>{y=!1,m="triangle",l.style.pointerEvents="auto",w("triangleBtn")};document.getElementById("circleBtn").onclick=()=>{y=!1,m="circle",l.style.pointerEvents="auto",w("circleBtn")};document.getElementById("arrowBtn").onclick=()=>{y=!1,m="arrow",l.style.pointerEvents="auto",w("arrowBtn")};document.getElementById("downloadBtn").onclick=()=>{p.trackDownload();const t=document.createElement("canvas");t.width=E.clientWidth,t.height=E.clientHeight;const e=t.getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.onload=()=>{e.drawImage(a,0,0,t.width,t.height),e.drawImage(l,0,0);let r=0;const u=I.length;if(u===0){z(t);return}I.forEach(d=>{const O=new Image;O.onload=()=>{const k=document.createElement("canvas");k.width=d.el.offsetWidth,k.height=d.el.offsetHeight;const f=k.getContext("2d");f.beginPath(),f.arc(d.el.offsetWidth/2,d.el.offsetHeight/2,d.el.offsetWidth/2-2,0,Math.PI*2),f.fillStyle=getComputedStyle(d.el).backgroundColor,f.fill(),f.strokeStyle=getComputedStyle(d.el).borderColor,f.lineWidth=2,f.stroke(),f.font="bold 14px Arial, sans-serif",f.fillStyle=getComputedStyle(d.el).color,f.textAlign="center",f.textBaseline="middle",f.fillText(d.el.textContent,d.el.offsetWidth/2,d.el.offsetHeight/2),e.drawImage(k,d.el.offsetLeft,d.el.offsetTop),r++,r===u&&z(t)},O.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};const o=A[L][C];a.src=o.backgroundImage};function z(t){const e=document.createElement("a");e.download=`quadro-tatico-${L}-${C}.png`,e.href=t.toDataURL("image/png"),e.click()}document.getElementById("drawOffBtn").click();v();setTimeout(()=>{p.trackVisit()},1e3);
