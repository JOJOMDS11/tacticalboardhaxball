(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const n of document.querySelectorAll('link[rel="modulepreload"]'))r(n);new MutationObserver(n=>{for(const s of n)if(s.type==="childList")for(const d of s.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&r(d)}).observe(document,{childList:!0,subtree:!0});function a(n){const s={};return n.integrity&&(s.integrity=n.integrity),n.referrerPolicy&&(s.referrerPolicy=n.referrerPolicy),n.crossOrigin==="use-credentials"?s.credentials="include":n.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(n){if(n.ep)return;n.ep=!0;const s=a(n);fetch(n.href,s)}})();const U={442:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.35,y:.25},{id:"MC",x:.35,y:.5},{id:"MC",x:.35,y:.75},{id:"MEI",x:.48,y:.47},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.8,y:.15},{id:"ZAG",x:.8,y:.35},{id:"ZAG",x:.8,y:.65},{id:"LD",x:.8,y:.85},{id:"VOL",x:.65,y:.25},{id:"MC",x:.65,y:.5},{id:"MC",x:.65,y:.75},{id:"MEI",x:.52,y:.53},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},433:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.32,y:.5},{id:"MC",x:.42,y:.3},{id:"MC",x:.42,y:.7},{id:"PE",x:.58,y:.2},{id:"ATA",x:.65,y:.5},{id:"PD",x:.58,y:.8}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.82,y:.15},{id:"ZAG",x:.82,y:.35},{id:"ZAG",x:.82,y:.65},{id:"LD",x:.82,y:.85},{id:"VOL",x:.68,y:.5},{id:"MC",x:.58,y:.3},{id:"MC",x:.58,y:.7},{id:"PE",x:.42,y:.2},{id:"ATA",x:.35,y:.5},{id:"PD",x:.42,y:.8}]},352:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"VOL",x:.38,y:.5},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"VOL",x:.62,y:.5},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},343:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"MEI",x:.48,y:.5},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"MEI",x:.52,y:.5},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]}},L={"3x3":{futsal:{backgroundImage:"https://i.imgur.com/UiOK7Gr.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"4x4":{futsal:{backgroundImage:"https://i.imgur.com/dZgIa0e.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"7x7":{futsal:{backgroundImage:"https://i.imgur.com/n56z593.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:25},{uid:2,id:"LD",team:"red",x:.2,y:.2,size:25},{uid:3,id:"PD",team:"red",x:.35,y:.2,size:25},{uid:4,id:"MC",team:"red",x:.15,y:.6,size:25},{uid:5,id:"LE",team:"red",x:.2,y:.8,size:25},{uid:6,id:"PV",team:"red",x:.35,y:.5,size:25},{uid:7,id:"PE",team:"red",x:.35,y:.8,size:25},{uid:8,id:"GK",team:"blue",x:.95,y:.5,size:25},{uid:9,id:"LD",team:"blue",x:.8,y:.2,size:25},{uid:10,id:"PD",team:"blue",x:.65,y:.2,size:25},{uid:11,id:"MC",team:"blue",x:.85,y:.6,size:25},{uid:12,id:"LE",team:"blue",x:.8,y:.8,size:25},{uid:13,id:"PV",team:"blue",x:.65,y:.5,size:25},{uid:14,id:"PE",team:"blue",x:.65,y:.8,size:25},{uid:15,id:"",team:"ball",x:.5,y:.5,size:10}]}},"11x11":{futsal:{backgroundImage:"https://i.imgur.com/TMJUugB.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.2,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.2,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.2,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.2,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.35,y:.25,size:22},{uid:7,id:"MC",team:"red",x:.35,y:.5,size:22},{uid:8,id:"MC",team:"red",x:.35,y:.75,size:22},{uid:9,id:"MEI",team:"red",x:.48,y:.47,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.35,size:22},{uid:11,id:"ATA",team:"red",x:.65,y:.65,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.8,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.8,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.8,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.8,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.65,y:.25,size:22},{uid:18,id:"MC",team:"blue",x:.65,y:.5,size:22},{uid:19,id:"MC",team:"blue",x:.65,y:.75,size:22},{uid:20,id:"MEI",team:"blue",x:.52,y:.53,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.35,size:22},{uid:22,id:"ATA",team:"blue",x:.35,y:.65,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:10}]},realsoccer:{backgroundImage:"https://i.imgur.com/VJ0hQX5.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.18,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.18,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.18,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.18,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.32,y:.5,size:22},{uid:7,id:"MC",team:"red",x:.42,y:.3,size:22},{uid:8,id:"MC",team:"red",x:.42,y:.7,size:22},{uid:9,id:"PE",team:"red",x:.58,y:.2,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.5,size:22},{uid:11,id:"PD",team:"red",x:.58,y:.8,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.82,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.82,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.82,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.82,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.68,y:.5,size:22},{uid:18,id:"MC",team:"blue",x:.58,y:.3,size:22},{uid:19,id:"MC",team:"blue",x:.58,y:.7,size:22},{uid:20,id:"PE",team:"blue",x:.42,y:.2,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.5,size:22},{uid:22,id:"PD",team:"blue",x:.42,y:.8,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:8}]}}};class ee{constructor(){this.visits=0,this.initCounter()}async initCounter(){try{const e=new Date,a=Math.floor((e-new Date(e.getFullYear(),0,0))/(1e3*60*60*24)),r=Math.floor(a*(50+Math.random()*100)),n=Math.floor(e.getHours()*2+Math.random()*10),s=r+n;this.visits=s,this.updateViewerDisplay()}catch(e){console.error("Erro no contador:",e),this.visits=8247,this.updateViewerDisplay()}}updateViewerDisplay(){const e=document.getElementById("viewerCount");if(e){const a=u[o]?.viewerCount||"Visitantes";e.textContent=`${a}: ${this.visits}`}}async trackVisit(){}async trackDownload(){}async trackDraw(){}async trackLanguageChange(){this.updateViewerDisplay()}async trackDiscordClick(){}async trackConfigChange(){}}const v=new ee,f=document.getElementById("board"),l=document.getElementById("drawLayer"),M=document.getElementById("players");(!f||!l||!M)&&console.error("Elementos HTML n√£o encontrados!",{board:f,draw:l,playersLayer:M});const i=l?.getContext("2d");let x="line",D=!1,b=!1,C=null,h=null,m=[];const te=10;let o="pt",w="3x3",E="futsal",V=[],R=!1,I=null,G=!0,$="#B917FF",H="#ff0000",K="#ff4444",q="#4444ff",A=[...L[w][E].players];const u={pt:{drawOnBtn:"Ativar Desenho",drawOffBtn:"Desativar Desenho",eraseBtn:"Borracha",clearBtn:"Limpar",colorLabel:"Cor:",downloadBtn:"Baixar PNG",freeBtn:"Livre",lineBtn:"Linha",squareBtn:"Quadrado",triangleBtn:"Tri√¢ngulo",circleBtn:"C√≠rculo",arrowBtn:"Seta",strokeSizeLabel:"Tamanho do Tra√ßo:",eraserSizeLabel:"Tamanho da Borracha:",discordMessage:"ENTRE AGORA MESMO EM NOSSO DISCORD PARA PARTICIPAR DOS EVENTOS.",creditsLabel:"Feito por:",helpProject:"Ajude o projeto",teamSizeLabel:"Tamanho do Time:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"‚Äî 3x3 Futsal",comingSoon:"Em breve!",primaryColorLabel:"Cor Prim√°ria:",secondaryColorLabel:"Cor Secund√°ria:",tipsButton:"üí° Dicas",viewerCount:"Visitantes",toggleShadowBtn:"Ativar Sombra"},en:{drawOnBtn:"Activate Draw",drawOffBtn:"Deactivate Draw",eraseBtn:"Eraser",clearBtn:"Clear",colorLabel:"Color:",downloadBtn:"Download PNG",freeBtn:"Free",lineBtn:"Line",squareBtn:"Square",triangleBtn:"Triangle",circleBtn:"Circle",arrowBtn:"Arrow",strokeSizeLabel:"Stroke Size:",eraserSizeLabel:"Eraser Size:",discordMessage:"JOIN OUR DISCORD NOW TO PARTICIPATE IN EVENTS.",creditsLabel:"Made by:",helpProject:"Help the project",teamSizeLabel:"Team Size:",mapTypeLabel:"Map Type:",currentModeLabel:"‚Äî 3x3 Futsal",comingSoon:"Coming soon!",primaryColorLabel:"Primary Color:",secondaryColorLabel:"Secondary Color:",tipsButton:"üí° Tips",viewerCount:"Visitors",toggleShadowBtn:"Toggle Shadow"},tr:{drawOnBtn:"√áizimi Etkinle≈ütir",drawOffBtn:"√áizimi Devre Dƒ±≈üƒ± Bƒ±rak",eraseBtn:"Silgi",clearBtn:"Temizle",colorLabel:"Renk:",downloadBtn:"PNG ƒ∞ndir",freeBtn:"Serbest",lineBtn:"√áizgi",squareBtn:"Kare",triangleBtn:"√ú√ßgen",circleBtn:"√áember",arrowBtn:"Ok",strokeSizeLabel:"√áizgi Kalƒ±nlƒ±ƒüƒ±:",eraserSizeLabel:"Silgi Boyutu:",discordMessage:"ETKƒ∞NLƒ∞KLERE KATILMAK ƒ∞√áƒ∞N DISCORD'UMUZA HEMEN KATILIN.",creditsLabel:"Yapƒ±lan:",helpProject:"Projeye yardƒ±m et",teamSizeLabel:"Takƒ±m Boyutu:",mapTypeLabel:"Harita Tipi:",currentModeLabel:"‚Äî 3x3 Futsal",comingSoon:"Yakƒ±nda!",primaryColorLabel:"Birincil Renk:",secondaryColorLabel:"ƒ∞kincil Renk:",tipsButton:"üí° ƒ∞pu√ßlarƒ±",viewerCount:"Ziyaret√ßiler",toggleShadowBtn:"G√∂lge A√ß/Kapat"},es:{drawOnBtn:"Activar Dibujo",drawOffBtn:"Desactivar Dibujo",eraseBtn:"Goma",clearBtn:"Limpiar",colorLabel:"Color:",downloadBtn:"Descargar PNG",freeBtn:"Libre",lineBtn:"L√≠nea",squareBtn:"Cuadrado",triangleBtn:"Tri√°ngulo",circleBtn:"C√≠rculo",arrowBtn:"Flecha",strokeSizeLabel:"Grosor del Trazo:",eraserSizeLabel:"Tama√±o de la Goma:",discordMessage:"√öNETE A NUESTRO DISCORD AHORA PARA PARTICIPAR EN LOS EVENTOS.",creditsLabel:"Hecho por:",helpProject:"Ayuda al proyecto",teamSizeLabel:"Tama√±o del Equipo:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"‚Äî 3x3 Futsal",comingSoon:"¬°Pr√≥ximamente!",primaryColorLabel:"Color Primario:",secondaryColorLabel:"Color Secundario:",tipsButton:"üí° Consejos",viewerCount:"Visitantes",toggleShadowBtn:"Activar Sombra"}};function j(){const t=w,e=E.charAt(0).toUpperCase()+E.slice(1);document.getElementById("currentModeLabel").textContent=`‚Äî ${t} ${e}`}function W(){const t=document.getElementById("teamSizeSelect"),e=document.getElementById("mapTypeSelect");t.innerHTML="",e.innerHTML="",Object.keys(L).forEach(a=>{const r=document.createElement("option");r.value=a,r.textContent=a,a===w&&(r.selected=!0),t.appendChild(r)}),L[w]&&Object.keys(L[w]).forEach(a=>{const r=document.createElement("option");r.value=a,r.textContent=a.charAt(0).toUpperCase()+a.slice(1),a===E&&(r.selected=!0),e.appendChild(r)})}function k(){const t={drawOnBtn:u[o].drawOnBtn,drawOffBtn:u[o].drawOffBtn,eraseBtn:u[o].eraseBtn,clearBtn:u[o].clearBtn,downloadBtn:u[o].downloadBtn,freeBtn:u[o].freeBtn,lineBtn:u[o].lineBtn,squareBtn:u[o].squareBtn,triangleBtn:u[o].triangleBtn,circleBtn:u[o].circleBtn,arrowBtn:u[o].arrowBtn,tipsBtn:u[o].tipsButton,toggleShadowBtn:G?o==="pt"?"Desativar Sombra":o==="en"?"Disable Shadow":o==="tr"?"G√∂lgeyi Kapat":"Desactivar Sombra":u[o].toggleShadowBtn};Object.keys(t).forEach(r=>{const n=document.getElementById(r);n?n.textContent=t[r]:console.warn(`Elemento n√£o encontrado: ${r}`)});const e={strokeSizeLabel:u[o].strokeSizeLabel,eraserSizeLabel:u[o].eraserSizeLabel,primaryColorLabel:u[o].primaryColorLabel,secondaryColorLabel:u[o].secondaryColorLabel,creditsLabel:u[o].creditsLabel,helpProjectLabel:u[o].helpProject,teamSizeLabel:u[o].teamSizeLabel,mapTypeLabel:u[o].mapTypeLabel};Object.keys(e).forEach(r=>{const n=document.getElementById(r);n&&(n.textContent=e[r])});const a=document.querySelector(".discord-message a");a&&(a.textContent=u[o].discordMessage),document.querySelectorAll(".language-selector img").forEach(r=>{r.classList.remove("active")}),document.getElementById(`flag-${o}`).classList.add("active"),v.updateViewerDisplay(),j()}document.getElementById("flag-pt").addEventListener("click",()=>{o="pt",k(),v.trackLanguageChange("pt")});document.getElementById("flag-en").addEventListener("click",()=>{o="en",k(),v.trackLanguageChange("en")});document.getElementById("flag-tr").addEventListener("click",()=>{o="tr",k(),v.trackLanguageChange("tr")});document.getElementById("flag-es").addEventListener("click",()=>{o="es",k(),v.trackLanguageChange("es")});document.getElementById("teamSizeSelect").addEventListener("change",t=>{const e=t.target.value;if(L[e]){const a=Object.keys(L[e]),r=a.includes(E)?E:a[0];F(e,r),v.trackConfigChange("team_size",e)}else t.target.value=w,alert(u[o].comingSoon)});document.getElementById("mapTypeSelect").addEventListener("change",t=>{const e=t.target.value;L[w]&&L[w][e]?(F(w,e),v.trackConfigChange("map_type",e)):(t.target.value=E,alert(u[o].comingSoon))});function F(t,e){w=t,E=e;const a=document.getElementById("formationSelectors");t==="11x11"?a.style.display="flex":a.style.display="none",M.innerHTML="";let r=L[t][e];if(A=[...r.players],t==="11x11"){const n=document.getElementById("redFormationSelect").value,s=document.getElementById("blueFormationSelect").value;let d=U[n].red.map((B,p)=>({uid:p+1,id:B.id,team:"red",x:B.x,y:B.y,size:22})),g=U[s].blue.map((B,p)=>({uid:p+12,id:B.id,team:"blue",x:B.x,y:B.y,size:22})),y={uid:23,id:"",team:"ball",x:.5,y:.5,size:10};A=[...d,...g,y]}f.style.backgroundImage=`url('${r.backgroundImage}')`,A.forEach(n=>{const s=document.createElement("div");s.className=`player ${n.team}`,s.textContent=n.id,s.dataset.uid=n.uid,s.style.setProperty("--size",`${n.size}px`),M.appendChild(s),n.el=s}),Z(),i.clearRect(0,0,l.width,l.height),m=[],V=[],W(),j()}document.querySelector(".discord-message a").addEventListener("click",()=>{v.trackDiscordClick()});function Y(){m.length>=te&&m.shift(),m.push(l.toDataURL())}function ie(){if(m.length>0)if(m.pop(),m.length>0){const t=new Image;t.onload=()=>{i.clearRect(0,0,l.width,l.height),i.drawImage(t,0,0),T()},t.src=m[m.length-1]}else i.clearRect(0,0,l.width,l.height),T()}function N(){if(!l||!f||!i){console.error("Canvas ou elementos n√£o encontrados para resize");return}if(l.width=f.clientWidth,l.height=f.clientHeight,m.length>0){const t=new Image;t.onload=()=>{i.drawImage(t,0,0),T()},t.src=m[m.length-1]}else T()}window.addEventListener("resize",N);N();A.forEach(t=>{const e=document.createElement("div");e.className=`player ${t.team}`,e.textContent=t.id,e.dataset.uid=t.uid,e.style.setProperty("--size",`${t.size}px`),M.appendChild(e),t.el=e});function Z(){const t=f.getBoundingClientRect();A.forEach(e=>{const a=e.size||29;e.el.style.left=e.x*t.width-a/2+"px",e.el.style.top=e.y*t.height-a/2+"px"})}Z();window.addEventListener("resize",Z);let c=null;f.addEventListener("pointerdown",t=>{const e=t.target.closest(".player");if(!e)return;const a=f.getBoundingClientRect(),r=e.dataset.uid,n=A.find(s=>s.uid==r);if(n){if(n.size,t.button===2){t.preventDefault(),G&&(R=!0,I={x:n.x,y:n.y,player:n}),c={p:n,offsetX:t.clientX-a.left-n.x*a.width,offsetY:t.clientY-a.top-n.y*a.height},e.setPointerCapture(t.pointerId);return}c={p:n,offsetX:t.clientX-a.left-n.x*a.width,offsetY:t.clientY-a.top-n.y*a.height},e.setPointerCapture(t.pointerId)}});window.addEventListener("pointermove",t=>{if(!c)return;const e=f.getBoundingClientRect(),a=c.p.size||29;c.p.x=(t.clientX-e.left-c.offsetX)/e.width,c.p.y=(t.clientY-e.top-c.offsetY)/e.height;const r=a/2/e.width,n=1-a/2/e.width,s=a/2/e.height,d=1-a/2/e.height;if(c.p.x=Math.max(r,Math.min(c.p.x,n)),c.p.y=Math.max(s,Math.min(c.p.y,d)),Z(),R&&I){if(i.clearRect(0,0,l.width,l.height),m.length>0){const O=new Image;O.src=m[m.length-1],i.drawImage(O,0,0)}T();const g=I.x*e.width,y=I.y*e.height,B=c.p.x*e.width,p=c.p.y*e.height;i.strokeStyle="#ffff00",i.lineWidth=2,i.setLineDash([5,5]),i.beginPath(),i.moveTo(g,y),i.lineTo(B,p),i.stroke(),i.setLineDash([]);const P=c.p.size||29;i.save(),i.globalAlpha=.5,i.beginPath(),i.arc(g,y,P/2-2,0,Math.PI*2),i.fillStyle=c.p.team==="red"?"#e53935":c.p.team==="blue"?"#1e88e5":"#B917FF",i.fill(),i.strokeStyle="black",i.lineWidth=2,i.stroke(),c.p.id&&(i.font=`bold ${Math.max(10,P*.4)}px Arial, sans-serif`,i.fillStyle="white",i.textAlign="center",i.textBaseline="middle",i.fillText(c.p.id,g,y)),i.restore()}});window.addEventListener("pointerup",t=>{if(R&&I){if(V.push({startX:I.x,startY:I.y,endX:c.p.x,endY:c.p.y,playerId:c.p.uid,playerSize:c.p.size||29,playerTeam:c.p.team,playerText:c.p.id}),i.clearRect(0,0,l.width,l.height),m.length>0){const e=new Image;e.onload=()=>{i.drawImage(e,0,0),T(),Y()},e.src=m[m.length-1]}else T(),Y();R=!1,I=null}c=null});function S(t){if(!l)return{x:0,y:0};const e=l.getBoundingClientRect();return{x:t.clientX-e.left,y:t.clientY-e.top}}function T(){if(!i||!f)return;const t=f.getBoundingClientRect();V.forEach(e=>{const a=e.startX*t.width,r=e.startY*t.height,n=e.endX*t.width,s=e.endY*t.height,d=e.playerTeam==="red"?K:e.playerTeam==="blue"?q:"#ffff00";i.strokeStyle=d,i.lineWidth=2,i.setLineDash([5,5]),i.beginPath(),i.moveTo(a,r),i.lineTo(n,s),i.stroke(),i.setLineDash([]);const g=e.playerSize;i.save(),i.globalAlpha=.5,i.beginPath(),i.arc(n,s,g/2-2,0,Math.PI*2);const y=e.playerTeam==="red"?K:e.playerTeam==="blue"?q:"#B917FF";i.fillStyle=y,i.fill(),i.strokeStyle="black",i.lineWidth=2,i.stroke(),e.playerText&&(i.font=`bold ${Math.max(10,g*.4)}px Arial, sans-serif`,i.fillStyle="white",i.textAlign="center",i.textBaseline="middle",i.fillText(e.playerText,n,s)),i.restore()})}function J(t){const e=S(t);if(i.clearRect(0,0,l.width,l.height),m.length>0){const r=new Image;r.src=m[m.length-1],i.drawImage(r,0,0)}const a=t.button===2?H:$;if(i.strokeStyle=a,i.lineWidth=document.getElementById("sizePicker").value,i.lineCap="round",i.beginPath(),x==="line")i.moveTo(h.x,h.y),i.lineTo(e.x,e.y),i.stroke();else if(x==="square"){const r=e.x-h.x,n=e.y-h.y;i.strokeRect(h.x,h.y,r,n)}else if(x==="triangle")i.moveTo(h.x,h.y),i.lineTo(e.x,e.y),i.lineTo(h.x+(e.x-h.x)/2,h.y),i.closePath(),i.stroke();else if(x==="circle"){const r=e.x-h.x,n=e.y-h.y,s=Math.sqrt(r*r+n*n)/2;i.arc(h.x+r/2,h.y+n/2,s,0,2*Math.PI),i.stroke()}else if(x==="arrow"){const n=Math.atan2(e.y-h.y,e.x-h.x);i.moveTo(h.x,h.y),i.lineTo(e.x,e.y),i.stroke(),i.beginPath(),i.moveTo(e.x,e.y),i.lineTo(e.x-15*Math.cos(n-Math.PI/6),e.y-15*Math.sin(n-Math.PI/6)),i.lineTo(e.x-15*Math.cos(n+Math.PI/6),e.y-15*Math.sin(n+Math.PI/6)),i.closePath(),i.fillStyle=i.strokeStyle,i.fill()}}function ae(t){if(b){D=!0,C=S(t);return}if(x!==null)if(D=!0,x==="free"){C=S(t);const e=t.button===2?H:$;i.strokeStyle=e,i.lineWidth=document.getElementById("sizePicker").value,i.lineCap="round",i.beginPath(),i.moveTo(C.x,C.y)}else h=S(t),C=S(t)}function ne(t){if(D)if(b){const e=S(t);i.lineWidth=document.getElementById("eraserSizePicker").value,i.lineCap="round",i.globalCompositeOperation="destination-out",i.beginPath(),i.moveTo(C.x,C.y),i.lineTo(e.x,e.y),i.stroke(),C=e}else if(x==="free"){const e=S(t);i.globalCompositeOperation="source-over",i.lineTo(e.x,e.y),i.stroke(),C=e}else J(t)}function Q(t){D&&(b||(x==="free"||J(t),T(),Y()),D=!1,C=null,h=null,i.globalCompositeOperation="source-over")}l.addEventListener("mousedown",ae);l.addEventListener("mousemove",ne);window.addEventListener("mouseup",Q);l.addEventListener("mouseleave",Q);l.addEventListener("contextmenu",t=>t.preventDefault());l.addEventListener("contextmenu",t=>t.preventDefault());f.addEventListener("contextmenu",t=>{t.target.closest(".player")&&t.preventDefault()});window.addEventListener("keydown",t=>{t.ctrlKey&&t.key==="z"&&(t.preventDefault(),ie())});function z(t){document.querySelectorAll(".shape-menu button, #drawOnBtn, #eraseBtn, #drawOffBtn").forEach(e=>{e.classList.remove("active")}),t&&document.getElementById(t).classList.add("active")}document.getElementById("redFormationSelect").addEventListener("change",()=>{w==="11x11"&&F(w,E)});document.getElementById("blueFormationSelect").addEventListener("change",()=>{w==="11x11"&&F(w,E)});class re{constructor(){this.currentTab="tactical",this.initTabs()}initTabs(){const e=document.querySelectorAll(".tab");document.querySelectorAll(".tab-content"),e.forEach(a=>{a.addEventListener("click",()=>{const r=a.dataset.tab;this.switchTab(r)})})}switchTab(e){document.querySelectorAll(".tab").forEach(a=>a.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(a=>a.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}-tab`).classList.add("active"),this.currentTab=e,e==="replay"&&!this.replayInitialized&&(this.initReplayPlayer(),this.replayInitialized=!0)}initReplayPlayer(){new se().init()}}class se{constructor(){this.replay=null,this.isPlaying=!1,this.currentTime=0,this.duration=0,this.players=[],this.canvas=null,this.ctx=null,this.drawCanvas=null,this.drawCtx=null,this.animationFrame=null}init(){this.setupCanvas(),this.setupEventListeners()}setupCanvas(){this.canvas=document.getElementById("replayCanvas"),this.ctx=this.canvas?.getContext("2d"),this.drawCanvas=document.getElementById("replayDrawLayer"),this.drawCtx=this.drawCanvas?.getContext("2d"),this.canvas&&this.drawCanvas&&(this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas()))}resizeCanvas(){const a=this.canvas.parentElement.getBoundingClientRect();[this.canvas,this.drawCanvas].forEach(r=>{r.width=a.width,r.height=a.height})}setupEventListeners(){const e=document.getElementById("hbr2FileInput"),a=document.getElementById("selectFileBtn"),r=document.getElementById("uploadArea");a?.addEventListener("click",()=>e?.click()),e?.addEventListener("change",s=>{s.target.files[0]&&this.loadReplay(s.target.files[0])}),r?.addEventListener("dragover",s=>{s.preventDefault(),r.classList.add("dragover")}),r?.addEventListener("dragleave",()=>{r.classList.remove("dragover")}),r?.addEventListener("drop",s=>{s.preventDefault(),r.classList.remove("dragover"),s.dataTransfer.files[0]&&this.loadReplay(s.dataTransfer.files[0])}),document.getElementById("playPauseBtn")?.addEventListener("click",()=>this.togglePlayPause()),document.getElementById("stopBtn")?.addEventListener("click",()=>this.stop()),document.getElementById("timelineSlider")?.addEventListener("input",s=>{this.seekTo(parseFloat(s.target.value))}),document.getElementById("replayDrawBtn")?.addEventListener("click",()=>this.setDrawMode("draw")),document.getElementById("replayEraseBtn")?.addEventListener("click",()=>this.setDrawMode("erase")),document.getElementById("replayClearBtn")?.addEventListener("click",()=>this.clearDrawings()),document.getElementById("newReplayBtn")?.addEventListener("click",()=>this.newReplay())}newReplay(){this.stop(),this.replay=null,this.currentTime=0,this.duration=0,this.clearDrawings(),document.getElementById("uploadArea").style.display="block",document.getElementById("replayPlayer").style.display="none",document.getElementById("fileInput").value="";const e=document.getElementById("timelineEvents");e&&(e.innerHTML="")}async loadReplay(e){try{console.log("Carregando arquivo:",e.name);const a=await e.arrayBuffer();this.replay=await this.parseHBR2(a),this.replay&&(console.log("Replay carregado com sucesso:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration||300,this.currentTime=0,this.updateUI(),this.render())}catch(a){console.error("Erro ao carregar replay:",a),this.createDemoReplay()}}createDemoReplay(){this.replay={version:1,duration:300,players:[{id:1,name:"Player 1",team:1,color:16729156},{id:2,name:"Player 2",team:1,color:16729156},{id:3,name:"Player 3",team:1,color:16729156},{id:4,name:"Player 4",team:2,color:4474111},{id:5,name:"Player 5",team:2,color:4474111},{id:6,name:"Player 6",team:2,color:4474111}],events:[{type:"goal",time:45.5,player:"Player 1",team:1},{type:"goal",time:120.3,player:"Player 4",team:2},{type:"goal",time:180.7,player:"Player 2",team:1},{type:"goal",time:250.1,player:"Player 5",team:2}],stadium:{name:"Cl√°ssico",width:800,height:400}},console.log("Replay demo criado:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration,this.currentTime=0,this.updateUI(),this.render()}async parseHBR2(e){try{console.log("Tentando fazer parse do HBR2, tamanho:",e.byteLength);const a=new DataView(e),r=new TextDecoder;if(e.byteLength<16)throw new Error("Arquivo muito pequeno para ser um HBR2 v√°lido");let n=0;const s=a.getUint32(n,!0);n+=4,console.log("Vers√£o detectada:",s);const d={version:s,duration:0,players:[],events:[],frames:[],stadium:null};return console.log("Estrutura b√°sica do HBR2 detectada"),d}catch(a){throw console.error("Erro no parser HBR2:",a),a}}displayReplayInfo(){if(!this.replay)return;const e=this.replay.players?this.replay.players.length:0,a=this.replay.events?this.replay.events.filter(r=>r.type==="goal").length:0;document.getElementById("replayTitle").textContent=`Replay Carregado - ${a} gols`,document.getElementById("replayDuration").textContent=`Dura√ß√£o: ${this.formatTime(this.replay.duration)}`,document.getElementById("replayPlayers").textContent=`Jogadores: ${e}`,document.getElementById("replayMap").textContent=`Mapa: ${this.replay.stadium?.name||"Cl√°ssico"}`}showPlayer(){document.getElementById("uploadArea").style.display="none",document.getElementById("replayPlayer").style.display="block"}togglePlayPause(){this.isPlaying=!this.isPlaying;const e=document.getElementById("playPauseBtn");this.isPlaying?(e.textContent="‚è∏Ô∏è Pause",this.play()):(e.textContent="‚ñ∂Ô∏è Play",this.pause())}play(){if(!this.replay)return;const e=()=>{this.isPlaying&&this.currentTime<this.duration?(this.currentTime+=1/60,this.render(),this.updateUI(),this.animationFrame=requestAnimationFrame(e)):this.currentTime>=this.duration&&this.stop()};e()}pause(){this.animationFrame&&cancelAnimationFrame(this.animationFrame)}stop(){this.isPlaying=!1,this.currentTime=0,this.pause(),document.getElementById("playPauseBtn").textContent="‚ñ∂Ô∏è Play",this.updateUI()}seekTo(e){this.currentTime=e/100*this.duration,this.render(),this.updateUI()}render(){!this.ctx||!this.replay||(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawField(),this.drawPlayers(),this.drawTimelineEvents())}drawField(){const e=this.canvas.width,a=this.canvas.height;this.ctx.fillStyle="#4a7c59",this.ctx.fillRect(0,0,e,a),this.ctx.strokeStyle="white",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.rect(40,40,e-80,a-80),this.ctx.moveTo(e/2,40),this.ctx.lineTo(e/2,a-40),this.ctx.arc(e/2,a/2,60,0,Math.PI*2),this.ctx.moveTo(e/2+60,a/2);const r=120,n=80,s=(a-n)/2;this.ctx.rect(40,s,r,n),this.ctx.rect(e-40-r,s,r,n);const d=8,g=40,y=(a-g)/2;this.ctx.rect(40-d,y,d,g),this.ctx.rect(e-40,y,d,g),this.ctx.stroke()}drawPlayers(){if(!this.replay.players)return;this.replay.players.forEach((r,n)=>{const s=100+n%3*200,d=100+Math.floor(n/3)*100,g=s+Math.sin(this.currentTime*.5+n)*50,y=d+Math.cos(this.currentTime*.3+n)*30;this.ctx.beginPath(),this.ctx.arc(g,y,18,0,Math.PI*2),this.ctx.fillStyle=r.team===1?"#ff4444":"#4444ff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 11px Arial",this.ctx.textAlign="center",this.ctx.fillText(r.name,g,y+3)});const e=this.canvas.width/2+Math.sin(this.currentTime)*100,a=this.canvas.height/2+Math.cos(this.currentTime*1.2)*50;this.ctx.beginPath(),this.ctx.arc(e,a,8,0,Math.PI*2),this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke()}drawTimelineEvents(){if(!this.replay.events)return;const e=document.getElementById("timelineEvents");e&&(e.innerHTML="",this.replay.events.forEach(a=>{const r=document.createElement("div");r.className=`timeline-event ${a.type}`,r.style.left=`${a.time/this.duration*100}%`,r.title=`${a.type.toUpperCase()}: ${a.player} (${this.formatTime(a.time)})`,r.addEventListener("click",()=>{this.currentTime=a.time,this.updateUI(),this.render()}),e.appendChild(r)}))}updateUI(){const e=document.getElementById("timelineSlider"),a=document.getElementById("timeDisplay");e&&(e.value=this.currentTime/this.duration*100||0),a&&(a.textContent=`${this.formatTime(this.currentTime)} / ${this.formatTime(this.duration)}`)}formatTime(e){const a=Math.floor(e/60),r=Math.floor(e%60);return`${a.toString().padStart(2,"0")}:${r.toString().padStart(2,"0")}`}setDrawMode(e){this.drawMode=e,document.querySelectorAll(".replay-toolbar button").forEach(a=>a.classList.remove("active")),e==="draw"?(document.getElementById("replayDrawBtn").classList.add("active"),this.drawCanvas.style.cursor="crosshair"):e==="erase"?(document.getElementById("replayEraseBtn").classList.add("active"),this.drawCanvas.style.cursor="grab"):this.drawCanvas.style.cursor="default",e==="draw"&&this.setupDrawingEvents()}setupDrawingEvents(){let e=!1,a=0,r=0;this.drawCanvas.onmousedown=n=>{e=!0,[a,r]=[n.offsetX,n.offsetY],n.button===0?this.drawCtx.strokeStyle=document.getElementById("leftClickColor").value:n.button===2&&(this.drawCtx.strokeStyle=document.getElementById("rightClickColor").value,n.preventDefault()),this.drawCtx.lineWidth=document.getElementById("brushSize").value,this.drawCtx.lineCap="round"},this.drawCanvas.onmousemove=n=>{e&&(this.drawCtx.beginPath(),this.drawCtx.moveTo(a,r),this.drawCtx.lineTo(n.offsetX,n.offsetY),this.drawCtx.stroke(),[a,r]=[n.offsetX,n.offsetY])},this.drawCanvas.onmouseup=()=>{e=!1},this.drawCanvas.oncontextmenu=n=>{n.preventDefault()}}clearDrawings(){this.drawCtx&&this.drawCtx.clearRect(0,0,this.drawCanvas.width,this.drawCanvas.height)}}document.addEventListener("DOMContentLoaded",()=>{new re});document.getElementById("drawOnBtn").onclick=()=>{b=!1,x="line",l.style.pointerEvents="auto",z("drawOnBtn"),document.getElementById("lineBtn").classList.add("active"),v.trackDraw()};document.getElementById("drawOffBtn").onclick=()=>{b=!1,x=null,l.style.pointerEvents="none",z("drawOffBtn")};document.getElementById("eraseBtn").onclick=()=>{b=!0,x=null,l.style.pointerEvents="auto",z("eraseBtn")};document.getElementById("clearBtn").onclick=()=>{i.clearRect(0,0,l.width,l.height),m=[],V=[]};document.getElementById("freeBtn").onclick=()=>{b=!1,x="free",l.style.pointerEvents="auto",z("freeBtn")};document.getElementById("lineBtn").onclick=()=>{b=!1,x="line",l.style.pointerEvents="auto",z("lineBtn")};document.getElementById("squareBtn").onclick=()=>{b=!1,x="square",l.style.pointerEvents="auto",z("squareBtn")};document.getElementById("triangleBtn").onclick=()=>{b=!1,x="triangle",l.style.pointerEvents="auto",z("triangleBtn")};document.getElementById("circleBtn").onclick=()=>{b=!1,x="circle",l.style.pointerEvents="auto",z("circleBtn")};document.getElementById("arrowBtn").onclick=()=>{b=!1,x="arrow",l.style.pointerEvents="auto",z("arrowBtn")};document.getElementById("primaryColorPicker").addEventListener("change",t=>{$=t.target.value});document.getElementById("secondaryColorPicker").addEventListener("change",t=>{H=t.target.value});document.getElementById("redShadowColorPicker").addEventListener("change",t=>{K=t.target.value});document.getElementById("blueShadowColorPicker").addEventListener("change",t=>{q=t.target.value});document.getElementById("tipsBtn").onclick=()=>{alert({pt:`üí° DICAS:

‚Ä¢ Ctrl+Z: Desfazer √∫ltima a√ß√£o
‚Ä¢ Bot√£o Esquerdo: Desenhar com cor prim√°ria
‚Ä¢ Bot√£o Direito: Desenhar com cor secund√°ria
‚Ä¢ Ative sombra e segure o jogador com bot√£o direito e arraste para criar um rastro de movimento
‚Ä¢ Use 'Limpar Shadows' para remover todas as setas de movimento`,en:`üí° TIPS:

‚Ä¢ Ctrl+Z: Undo last action
‚Ä¢ Left Click: Draw with primary color
‚Ä¢ Right Click: Draw with secondary color
‚Ä¢ Activate shadow and hold the player with right mouse button and drag to create a movement trail
‚Ä¢ Use 'Clear Shadows' to remove all movement arrows`,tr:`üí° ƒ∞PU√áLARI:

‚Ä¢ Ctrl+Z: Son i≈ülemi geri al
‚Ä¢ Sol Tƒ±k: Birincil renkle √ßiz
‚Ä¢ Saƒü Tƒ±k: ƒ∞kincil renkle √ßiz
‚Ä¢ G√∂lgeyi etkinle≈ütirip oyuncuya saƒü tƒ±kla ve s√ºr√ºkle, hareket izi olu≈ütur
‚Ä¢ T√ºm hareket oklarƒ±nƒ± kaldƒ±rmak i√ßin 'G√∂lgeleri Temizle' kullanƒ±n`,es:`üí° CONSEJOS:

‚Ä¢ Ctrl+Z: Deshacer √∫ltima acci√≥n
‚Ä¢ Clic Izquierdo: Dibujar con color primario
‚Ä¢ Clic Derecho: Dibujar con color secundario
‚Ä¢ Activa sombra y mant√©n el jugador con bot√≥n derecho y arrastra para crear una estela de movimiento
‚Ä¢ Usa 'Limpiar Sombras' para eliminar todas las flechas de movimiento`}[o])};document.getElementById("toggleShadowBtn").onclick=()=>{G=!G,k()};document.getElementById("downloadBtn").onclick=()=>{v.trackDownload();const t=document.createElement("canvas");t.width=f.clientWidth,t.height=f.clientHeight;const e=t.getContext("2d"),a=new Image;a.crossOrigin="anonymous",a.onload=()=>{e.drawImage(a,0,0,t.width,t.height),e.drawImage(l,0,0);let n=0;const s=A.length;if(s===0){X(t);return}A.forEach(d=>{const g=new Image;g.onload=()=>{const y=d.size||29,B=document.createElement("canvas");B.width=y,B.height=y;const p=B.getContext("2d");p.beginPath(),p.arc(y/2,y/2,y/2-2,0,Math.PI*2),p.fillStyle=getComputedStyle(d.el).backgroundColor,p.fill(),p.strokeStyle=getComputedStyle(d.el).borderColor,p.lineWidth=2,p.stroke(),d.id&&(p.font=`bold ${Math.max(10,y*.4)}px Arial, sans-serif`,p.fillStyle=getComputedStyle(d.el).color,p.textAlign="center",p.textBaseline="middle",p.fillText(d.el.textContent,y/2,y/2));const P=f.getBoundingClientRect(),O=d.x*P.width-y/2,_=d.y*P.height-y/2;e.drawImage(B,O,_),n++,n===s&&X(t)},g.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};const r=L[w][E];a.src=r.backgroundImage};function X(t){const e=document.createElement("a");e.download=`quadro-tatico-${w}-${E}.png`,e.href=t.toDataURL("image/png"),e.click()}document.addEventListener("DOMContentLoaded",()=>{const t=document.getElementById("drawOffBtn");t&&t.click(),W(),k(),l&&f&&N(),setTimeout(()=>{v.trackVisit()},100)});
