(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const o of document.querySelectorAll('link[rel="modulepreload"]'))n(o);new MutationObserver(o=>{for(const r of o)if(r.type==="childList")for(const d of r.addedNodes)d.tagName==="LINK"&&d.rel==="modulepreload"&&n(d)}).observe(document,{childList:!0,subtree:!0});function t(o){const r={};return o.integrity&&(r.integrity=o.integrity),o.referrerPolicy&&(r.referrerPolicy=o.referrerPolicy),o.crossOrigin==="use-credentials"?r.credentials="include":o.crossOrigin==="anonymous"?r.credentials="omit":r.credentials="same-origin",r}function n(o){if(o.ep)return;o.ep=!0;const r=t(o);fetch(o.href,r)}})();const U={442:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.35,y:.25},{id:"MC",x:.35,y:.5},{id:"MC",x:.35,y:.75},{id:"MEI",x:.48,y:.47},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.8,y:.15},{id:"ZAG",x:.8,y:.35},{id:"ZAG",x:.8,y:.65},{id:"LD",x:.8,y:.85},{id:"VOL",x:.65,y:.25},{id:"MC",x:.65,y:.5},{id:"MC",x:.65,y:.75},{id:"MEI",x:.52,y:.53},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},433:{red:[{id:"GK",x:.05,y:.5},{id:"LE",x:.2,y:.15},{id:"ZAG",x:.2,y:.35},{id:"ZAG",x:.2,y:.65},{id:"LD",x:.2,y:.85},{id:"VOL",x:.32,y:.5},{id:"MC",x:.42,y:.3},{id:"MC",x:.42,y:.7},{id:"PE",x:.58,y:.2},{id:"ATA",x:.65,y:.5},{id:"PD",x:.58,y:.8}],blue:[{id:"GK",x:.95,y:.5},{id:"LE",x:.82,y:.15},{id:"ZAG",x:.82,y:.35},{id:"ZAG",x:.82,y:.65},{id:"LD",x:.82,y:.85},{id:"VOL",x:.68,y:.5},{id:"MC",x:.58,y:.3},{id:"MC",x:.58,y:.7},{id:"PE",x:.42,y:.2},{id:"ATA",x:.35,y:.5},{id:"PD",x:.42,y:.8}]},352:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"VOL",x:.38,y:.5},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"VOL",x:.62,y:.5},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]},343:{red:[{id:"GK",x:.05,y:.5},{id:"ZAG",x:.18,y:.25},{id:"ZAG",x:.18,y:.5},{id:"ZAG",x:.18,y:.75},{id:"LE",x:.32,y:.15},{id:"LD",x:.32,y:.85},{id:"MC",x:.45,y:.3},{id:"MC",x:.45,y:.7},{id:"MEI",x:.48,y:.5},{id:"ATA",x:.65,y:.35},{id:"ATA",x:.65,y:.65}],blue:[{id:"GK",x:.95,y:.5},{id:"ZAG",x:.82,y:.25},{id:"ZAG",x:.82,y:.5},{id:"ZAG",x:.82,y:.75},{id:"LE",x:.68,y:.15},{id:"LD",x:.68,y:.85},{id:"MC",x:.55,y:.3},{id:"MC",x:.55,y:.7},{id:"MEI",x:.52,y:.5},{id:"ATA",x:.35,y:.35},{id:"ATA",x:.35,y:.65}]}},I={"3x3":{futsal:{backgroundImage:"https://i.imgur.com/UiOK7Gr.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.25,y:.25,size:29},{uid:3,id:"PV",team:"red",x:.25,y:.75,size:29},{uid:4,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:5,id:"VL",team:"blue",x:.75,y:.25,size:29},{uid:6,id:"PV",team:"blue",x:.75,y:.75,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"4x4":{futsal:{backgroundImage:"https://i.imgur.com/dZgIa0e.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]},bigeasy:{backgroundImage:"https://i.imgur.com/rMetuYd.png",players:[{uid:1,id:"GK",team:"red",x:.1,y:.5,size:29},{uid:2,id:"VL",team:"red",x:.3,y:.3,size:29},{uid:3,id:"MC",team:"red",x:.3,y:.7,size:29},{uid:4,id:"PV",team:"red",x:.45,y:.5,size:29},{uid:5,id:"GK",team:"blue",x:.9,y:.5,size:29},{uid:6,id:"VL",team:"blue",x:.7,y:.3,size:29},{uid:7,id:"MC",team:"blue",x:.7,y:.7,size:29},{uid:8,id:"PV",team:"blue",x:.55,y:.5,size:29},{uid:10,id:"",team:"ball",x:.5,y:.5,size:12}]}},"7x7":{futsal:{backgroundImage:"https://i.imgur.com/n56z593.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:25},{uid:2,id:"LD",team:"red",x:.2,y:.2,size:25},{uid:3,id:"PD",team:"red",x:.35,y:.2,size:25},{uid:4,id:"MC",team:"red",x:.15,y:.6,size:25},{uid:5,id:"LE",team:"red",x:.2,y:.8,size:25},{uid:6,id:"PV",team:"red",x:.35,y:.5,size:25},{uid:7,id:"PE",team:"red",x:.35,y:.8,size:25},{uid:8,id:"GK",team:"blue",x:.95,y:.5,size:25},{uid:9,id:"LD",team:"blue",x:.8,y:.2,size:25},{uid:10,id:"PD",team:"blue",x:.65,y:.2,size:25},{uid:11,id:"MC",team:"blue",x:.85,y:.6,size:25},{uid:12,id:"LE",team:"blue",x:.8,y:.8,size:25},{uid:13,id:"PV",team:"blue",x:.65,y:.5,size:25},{uid:14,id:"PE",team:"blue",x:.65,y:.8,size:25},{uid:15,id:"",team:"ball",x:.5,y:.5,size:10}]}},"11x11":{futsal:{backgroundImage:"https://i.imgur.com/TMJUugB.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.2,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.2,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.2,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.2,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.35,y:.25,size:22},{uid:7,id:"MC",team:"red",x:.35,y:.5,size:22},{uid:8,id:"MC",team:"red",x:.35,y:.75,size:22},{uid:9,id:"MEI",team:"red",x:.48,y:.47,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.35,size:22},{uid:11,id:"ATA",team:"red",x:.65,y:.65,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.8,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.8,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.8,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.8,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.65,y:.25,size:22},{uid:18,id:"MC",team:"blue",x:.65,y:.5,size:22},{uid:19,id:"MC",team:"blue",x:.65,y:.75,size:22},{uid:20,id:"MEI",team:"blue",x:.52,y:.53,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.35,size:22},{uid:22,id:"ATA",team:"blue",x:.35,y:.65,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:10}]},realsoccer:{backgroundImage:"https://i.imgur.com/VJ0hQX5.png",players:[{uid:1,id:"GK",team:"red",x:.05,y:.5,size:22},{uid:2,id:"LE",team:"red",x:.18,y:.15,size:22},{uid:3,id:"ZAG",team:"red",x:.18,y:.35,size:22},{uid:4,id:"ZAG",team:"red",x:.18,y:.65,size:22},{uid:5,id:"LD",team:"red",x:.18,y:.85,size:22},{uid:6,id:"VOL",team:"red",x:.32,y:.5,size:22},{uid:7,id:"MC",team:"red",x:.42,y:.3,size:22},{uid:8,id:"MC",team:"red",x:.42,y:.7,size:22},{uid:9,id:"PE",team:"red",x:.58,y:.2,size:22},{uid:10,id:"ATA",team:"red",x:.65,y:.5,size:22},{uid:11,id:"PD",team:"red",x:.58,y:.8,size:22},{uid:12,id:"GK",team:"blue",x:.95,y:.5,size:22},{uid:13,id:"LE",team:"blue",x:.82,y:.15,size:22},{uid:14,id:"ZAG",team:"blue",x:.82,y:.35,size:22},{uid:15,id:"ZAG",team:"blue",x:.82,y:.65,size:22},{uid:16,id:"LD",team:"blue",x:.82,y:.85,size:22},{uid:17,id:"VOL",team:"blue",x:.68,y:.5,size:22},{uid:18,id:"MC",team:"blue",x:.58,y:.3,size:22},{uid:19,id:"MC",team:"blue",x:.58,y:.7,size:22},{uid:20,id:"PE",team:"blue",x:.42,y:.2,size:22},{uid:21,id:"ATA",team:"blue",x:.35,y:.5,size:22},{uid:22,id:"PD",team:"blue",x:.42,y:.8,size:22},{uid:23,id:"",team:"ball",x:.5,y:.5,size:8}]}}};class ne{constructor(){console.log("Usando hitwebcounter para contagem de visitantes"),this.initCounter()}async initCounter(){const e=document.getElementById("counterDisplay");if(e){const t=await this.tryMultipleCounters();e.textContent=t.toLocaleString()}}async tryMultipleCounters(){try{const e=await fetch("https://api.countapi.xyz/hit/jojohaxball.netlify.app/visits");if(e.ok){const t=await e.json();return console.log("Contador API funcionando:",t.value),t.value}}catch{console.log("Contador API falhou, tentando alternativa")}try{const e=new Image;return await new Promise((t,n)=>{e.onload=t,e.onerror=n,e.src="https://hitwebcounter.com/counter/counter.php?page=21445755&style=0034&nbdigits=5&type=page&initCount=100"}),console.log("Hitwebcounter funcionando"),this.getStoredCount()+1}catch{console.log("Hitwebcounter bloqueado, usando contador local")}return this.getLocalCounter()}getStoredCount(){return parseInt(localStorage.getItem("visitorCount")||"150")}getLocalCounter(){let e=this.getStoredCount();const t=localStorage.getItem("lastVisit"),n=Date.now(),o=3600*1e3;return(!t||n-parseInt(t)>o)&&(e++,localStorage.setItem("visitorCount",e.toString()),localStorage.setItem("lastVisit",n.toString())),e}async trackVisit(){}async trackDownload(){}async trackDraw(){}async trackLanguageChange(){}async trackDiscordClick(){}async trackConfigChange(){}updateViewerDisplay(){}}const E=new ne,x=document.getElementById("board"),s=document.getElementById("drawLayer"),O=document.getElementById("players");(!x||!s||!O)&&console.error("Elementos HTML não encontrados!",{board:x,draw:s,playersLayer:O});const a=s?.getContext("2d");let h="line",R=!1,v=!1,L=null,g=null,y=[];const oe=10;let l="pt",w="3x3",B="futsal",V=[],$=!1,T=null,S=!0,Y="#B917FF",q="#ff0000",j="#ff4444",F="#4444ff",A=[...I[w][B].players];const m={pt:{drawOnBtn:"Ativar Desenho",drawOffBtn:"Desativar Desenho",eraseBtn:"Borracha",clearBtn:"Limpar",colorLabel:"Cor:",downloadBtn:"Baixar PNG",freeBtn:"Livre",lineBtn:"Linha",squareBtn:"Quadrado",triangleBtn:"Triângulo",circleBtn:"Círculo",arrowBtn:"Seta",strokeSizeLabel:"Tamanho do Traço:",eraserSizeLabel:"Tamanho da Borracha:",discordMessage:"ENTRE AGORA MESMO EM NOSSO DISCORD PARA PARTICIPAR DOS EVENTOS.",creditsLabel:"Feito por:",helpProject:"Ajude o projeto",teamSizeLabel:"Tamanho do Time:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Em breve!",primaryColorLabel:"Cor Primária:",secondaryColorLabel:"Cor Secundária:",tipsButton:"💡 Dicas",viewerCount:"Visitantes",toggleShadowBtn:"Ativar Sombra"},en:{drawOnBtn:"Activate Draw",drawOffBtn:"Deactivate Draw",eraseBtn:"Eraser",clearBtn:"Clear",colorLabel:"Color:",downloadBtn:"Download PNG",freeBtn:"Free",lineBtn:"Line",squareBtn:"Square",triangleBtn:"Triangle",circleBtn:"Circle",arrowBtn:"Arrow",strokeSizeLabel:"Stroke Size:",eraserSizeLabel:"Eraser Size:",discordMessage:"JOIN OUR DISCORD NOW TO PARTICIPATE IN EVENTS.",creditsLabel:"Made by:",helpProject:"Help the project",teamSizeLabel:"Team Size:",mapTypeLabel:"Map Type:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Coming soon!",primaryColorLabel:"Primary Color:",secondaryColorLabel:"Secondary Color:",tipsButton:"💡 Tips",viewerCount:"Visitors",toggleShadowBtn:"Toggle Shadow"},tr:{drawOnBtn:"Çizimi Etkinleştir",drawOffBtn:"Çizimi Devre Dışı Bırak",eraseBtn:"Silgi",clearBtn:"Temizle",colorLabel:"Renk:",downloadBtn:"PNG İndir",freeBtn:"Serbest",lineBtn:"Çizgi",squareBtn:"Kare",triangleBtn:"Üçgen",circleBtn:"Çember",arrowBtn:"Ok",strokeSizeLabel:"Çizgi Kalınlığı:",eraserSizeLabel:"Silgi Boyutu:",discordMessage:"ETKİNLİKLERE KATILMAK İÇİN DISCORD'UMUZA HEMEN KATILIN.",creditsLabel:"Yapılan:",helpProject:"Projeye yardım et",teamSizeLabel:"Takım Boyutu:",mapTypeLabel:"Harita Tipi:",currentModeLabel:"— 3x3 Futsal",comingSoon:"Yakında!",primaryColorLabel:"Birincil Renk:",secondaryColorLabel:"İkincil Renk:",tipsButton:"💡 İpuçları",viewerCount:"Ziyaretçiler",toggleShadowBtn:"Gölge Aç/Kapat"},es:{drawOnBtn:"Activar Dibujo",drawOffBtn:"Desactivar Dibujo",eraseBtn:"Goma",clearBtn:"Limpiar",colorLabel:"Color:",downloadBtn:"Descargar PNG",freeBtn:"Libre",lineBtn:"Línea",squareBtn:"Cuadrado",triangleBtn:"Triángulo",circleBtn:"Círculo",arrowBtn:"Flecha",strokeSizeLabel:"Grosor del Trazo:",eraserSizeLabel:"Tamaño de la Goma:",discordMessage:"ÚNETE A NUESTRO DISCORD AHORA PARA PARTICIPAR EN LOS EVENTOS.",creditsLabel:"Hecho por:",helpProject:"Ayuda al proyecto",teamSizeLabel:"Tamaño del Equipo:",mapTypeLabel:"Tipo de Mapa:",currentModeLabel:"— 3x3 Futsal",comingSoon:"¡Próximamente!",primaryColorLabel:"Color Primario:",secondaryColorLabel:"Color Secundario:",tipsButton:"💡 Consejos",viewerCount:"Visitantes",toggleShadowBtn:"Activar Sombra"}};function W(){const i=w,e=B.charAt(0).toUpperCase()+B.slice(1);document.getElementById("currentModeLabel").textContent=`— ${i} ${e}`}function J(){const i=document.getElementById("teamSizeSelect"),e=document.getElementById("mapTypeSelect");i.innerHTML="",e.innerHTML="",Object.keys(I).forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t,t===w&&(n.selected=!0),i.appendChild(n)}),I[w]&&Object.keys(I[w]).forEach(t=>{const n=document.createElement("option");n.value=t,n.textContent=t.charAt(0).toUpperCase()+t.slice(1),t===B&&(n.selected=!0),e.appendChild(n)})}function z(){const i={drawOnBtn:m[l].drawOnBtn,drawOffBtn:m[l].drawOffBtn,eraseBtn:m[l].eraseBtn,clearBtn:m[l].clearBtn,downloadBtn:m[l].downloadBtn,freeBtn:m[l].freeBtn,lineBtn:m[l].lineBtn,squareBtn:m[l].squareBtn,triangleBtn:m[l].triangleBtn,circleBtn:m[l].circleBtn,arrowBtn:m[l].arrowBtn,tipsBtn:m[l].tipsButton,toggleShadowBtn:S?l==="pt"?"Desativar Sombra":l==="en"?"Disable Shadow":l==="tr"?"Gölgeyi Kapat":"Desactivar Sombra":m[l].toggleShadowBtn};Object.keys(i).forEach(n=>{const o=document.getElementById(n);o?o.textContent=i[n]:console.warn(`Elemento não encontrado: ${n}`)});const e={strokeSizeLabel:m[l].strokeSizeLabel,eraserSizeLabel:m[l].eraserSizeLabel,primaryColorLabel:m[l].primaryColorLabel,secondaryColorLabel:m[l].secondaryColorLabel,creditsLabel:m[l].creditsLabel,helpProjectLabel:m[l].helpProject,teamSizeLabel:m[l].teamSizeLabel,mapTypeLabel:m[l].mapTypeLabel};Object.keys(e).forEach(n=>{const o=document.getElementById(n);o&&(o.textContent=e[n])});const t=document.querySelector(".discord-message a");t&&(t.textContent=m[l].discordMessage),document.querySelectorAll(".language-selector img").forEach(n=>{n.classList.remove("active")}),document.getElementById(`flag-${l}`).classList.add("active"),E.updateViewerDisplay(),W()}document.getElementById("flag-pt").addEventListener("click",()=>{l="pt",z(),E.trackLanguageChange("pt")});document.getElementById("flag-en").addEventListener("click",()=>{l="en",z(),E.trackLanguageChange("en")});document.getElementById("flag-tr").addEventListener("click",()=>{l="tr",z(),E.trackLanguageChange("tr")});document.getElementById("flag-es").addEventListener("click",()=>{l="es",z(),E.trackLanguageChange("es")});document.getElementById("teamSizeSelect").addEventListener("change",i=>{const e=i.target.value;if(I[e]){const t=Object.keys(I[e]),n=t.includes(B)?B:t[0];Z(e,n),E.trackConfigChange("team_size",e)}else i.target.value=w,alert(m[l].comingSoon)});document.getElementById("mapTypeSelect").addEventListener("change",i=>{const e=i.target.value;I[w]&&I[w][e]?(Z(w,e),E.trackConfigChange("map_type",e)):(i.target.value=B,alert(m[l].comingSoon))});function Z(i,e){w=i,B=e;const t=document.getElementById("formationSelectors");i==="11x11"?t.style.display="flex":t.style.display="none",O.innerHTML="";let n=I[i][e];if(A=[...n.players],i==="11x11"){const o=document.getElementById("redFormationSelect").value,r=document.getElementById("blueFormationSelect").value;let d=U[o].red.map((b,f)=>({uid:f+1,id:b.id,team:"red",x:b.x,y:b.y,size:22})),p=U[r].blue.map((b,f)=>({uid:f+12,id:b.id,team:"blue",x:b.x,y:b.y,size:22})),u={uid:23,id:"",team:"ball",x:.5,y:.5,size:10};A=[...d,...p,u]}x.style.backgroundImage=`url('${n.backgroundImage}')`,A.forEach(o=>{const r=document.createElement("div");r.className=`player ${o.team}`,r.textContent=o.id,r.dataset.uid=o.uid,r.style.setProperty("--size",`${o.size}px`),O.appendChild(r),o.el=r}),K(),a.clearRect(0,0,s.width,s.height),y=[],V=[],J(),W()}document.querySelector(".discord-message a").addEventListener("click",()=>{E.trackDiscordClick()});function H(){y.length>=oe&&y.shift(),y.push(s.toDataURL())}function re(){if(y.length>0)if(y.pop(),y.length>0){const i=new Image;i.onload=()=>{a.clearRect(0,0,s.width,s.height),a.drawImage(i,0,0),k()},i.src=y[y.length-1]}else a.clearRect(0,0,s.width,s.height),k()}function N(){if(!s||!x||!a){console.error("Canvas ou elementos não encontrados para resize");return}if(s.width=x.clientWidth,s.height=x.clientHeight,y.length>0){const i=new Image;i.onload=()=>{a.drawImage(i,0,0),k()},i.src=y[y.length-1]}else k()}window.addEventListener("resize",N);N();A.forEach(i=>{const e=document.createElement("div");e.className=`player ${i.team}`,e.textContent=i.id,e.dataset.uid=i.uid,e.style.setProperty("--size",`${i.size}px`),O.appendChild(e),i.el=e});function K(){const i=x.getBoundingClientRect();A.forEach(e=>{const t=e.size||29;e.el.style.left=e.x*i.width-t/2+"px",e.el.style.top=e.y*i.height-t/2+"px"})}K();window.addEventListener("resize",K);let c=null;x.addEventListener("pointerdown",i=>{const e=i.target.closest(".player");if(!e)return;const t=x.getBoundingClientRect(),n=e.dataset.uid,o=A.find(r=>r.uid==n);if(o){if(o.size,i.button===2){i.preventDefault(),S&&($=!0,T={x:o.x,y:o.y,player:o}),c={p:o,offsetX:i.clientX-t.left-o.x*t.width,offsetY:i.clientY-t.top-o.y*t.height},e.setPointerCapture(i.pointerId);return}c={p:o,offsetX:i.clientX-t.left-o.x*t.width,offsetY:i.clientY-t.top-o.y*t.height},e.setPointerCapture(i.pointerId)}});window.addEventListener("pointermove",i=>{if(!c)return;const e=x.getBoundingClientRect(),t=c.p.size||29;c.p.x=(i.clientX-e.left-c.offsetX)/e.width,c.p.y=(i.clientY-e.top-c.offsetY)/e.height;const n=t/2/e.width,o=1-t/2/e.width,r=t/2/e.height,d=1-t/2/e.height;if(c.p.x=Math.max(n,Math.min(c.p.x,o)),c.p.y=Math.max(r,Math.min(c.p.y,d)),K(),$&&T){if(a.clearRect(0,0,s.width,s.height),y.length>0){const G=new Image;G.src=y[y.length-1],a.drawImage(G,0,0)}k();const p=T.x*e.width,u=T.y*e.height,b=c.p.x*e.width,f=c.p.y*e.height;a.strokeStyle="#ffff00",a.lineWidth=2,a.setLineDash([5,5]),a.beginPath(),a.moveTo(p,u),a.lineTo(b,f),a.stroke(),a.setLineDash([]);const M=c.p.size||29;a.save(),a.globalAlpha=.5,a.beginPath(),a.arc(p,u,M/2-2,0,Math.PI*2),a.fillStyle=c.p.team==="red"?"#e53935":c.p.team==="blue"?"#1e88e5":"#B917FF",a.fill(),a.strokeStyle="black",a.lineWidth=2,a.stroke(),c.p.id&&(a.font=`bold ${Math.max(10,M*.4)}px Arial, sans-serif`,a.fillStyle="white",a.textAlign="center",a.textBaseline="middle",a.fillText(c.p.id,p,u)),a.restore()}});window.addEventListener("pointerup",i=>{if($&&T){if(V.push({startX:T.x,startY:T.y,endX:c.p.x,endY:c.p.y,playerId:c.p.uid,playerSize:c.p.size||29,playerTeam:c.p.team,playerText:c.p.id}),a.clearRect(0,0,s.width,s.height),y.length>0){const e=new Image;e.onload=()=>{a.drawImage(e,0,0),k(),H()},e.src=y[y.length-1]}else k(),H();$=!1,T=null}c=null});function P(i){if(!s)return{x:0,y:0};const e=s.getBoundingClientRect();return{x:i.clientX-e.left,y:i.clientY-e.top}}function k(){if(!a||!x)return;const i=x.getBoundingClientRect();V.forEach(e=>{const t=e.startX*i.width,n=e.startY*i.height,o=e.endX*i.width,r=e.endY*i.height,d=e.playerTeam==="red"?j:e.playerTeam==="blue"?F:"#ffff00";a.strokeStyle=d,a.lineWidth=2,a.setLineDash([5,5]),a.beginPath(),a.moveTo(t,n),a.lineTo(o,r),a.stroke(),a.setLineDash([]);const p=e.playerSize;a.save(),a.globalAlpha=.5,a.beginPath(),a.arc(o,r,p/2-2,0,Math.PI*2);const u=e.playerTeam==="red"?j:e.playerTeam==="blue"?F:"#B917FF";a.fillStyle=u,a.fill(),a.strokeStyle="black",a.lineWidth=2,a.stroke(),e.playerText&&(a.font=`bold ${Math.max(10,p*.4)}px Arial, sans-serif`,a.fillStyle="white",a.textAlign="center",a.textBaseline="middle",a.fillText(e.playerText,o,r)),a.restore()})}function Q(i){const e=P(i);if(a.clearRect(0,0,s.width,s.height),y.length>0){const n=new Image;n.src=y[y.length-1],a.drawImage(n,0,0)}const t=i.button===2?q:Y;if(a.strokeStyle=t,a.lineWidth=document.getElementById("sizePicker").value,a.lineCap="round",a.beginPath(),h==="line")a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.stroke();else if(h==="square"){const n=e.x-g.x,o=e.y-g.y;a.strokeRect(g.x,g.y,n,o)}else if(h==="triangle")a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.lineTo(g.x+(e.x-g.x)/2,g.y),a.closePath(),a.stroke();else if(h==="circle"){const n=e.x-g.x,o=e.y-g.y,r=Math.sqrt(n*n+o*o)/2;a.arc(g.x+n/2,g.y+o/2,r,0,2*Math.PI),a.stroke()}else if(h==="arrow"){const o=Math.atan2(e.y-g.y,e.x-g.x);a.moveTo(g.x,g.y),a.lineTo(e.x,e.y),a.stroke(),a.beginPath(),a.moveTo(e.x,e.y),a.lineTo(e.x-15*Math.cos(o-Math.PI/6),e.y-15*Math.sin(o-Math.PI/6)),a.lineTo(e.x-15*Math.cos(o+Math.PI/6),e.y-15*Math.sin(o+Math.PI/6)),a.closePath(),a.fillStyle=a.strokeStyle,a.fill()}}function se(i){if(v){R=!0,L=P(i);return}if(h!==null)if(H(),R=!0,h==="free"){L=P(i);const e=i.button===2?q:Y;a.strokeStyle=e,a.lineWidth=document.getElementById("sizePicker").value,a.lineCap="round",a.beginPath(),a.moveTo(L.x,L.y)}else g=P(i),L=P(i)}function le(i){if(R)if(v){const e=P(i);a.lineWidth=document.getElementById("eraserSizePicker").value,a.lineCap="round",a.globalCompositeOperation="destination-out",a.beginPath(),a.moveTo(L.x,L.y),a.lineTo(e.x,e.y),a.stroke(),L=e}else if(h==="free"){const e=P(i);a.globalCompositeOperation="source-over",a.lineTo(e.x,e.y),a.stroke(),L=e}else Q(i)}function _(i){R&&(v||(h==="free"||Q(i),k(),H()),R=!1,L=null,g=null,a.globalCompositeOperation="source-over")}s.addEventListener("mousedown",se);s.addEventListener("mousemove",le);window.addEventListener("mouseup",_);s.addEventListener("mouseleave",_);s.addEventListener("contextmenu",i=>i.preventDefault());s.addEventListener("contextmenu",i=>i.preventDefault());x.addEventListener("contextmenu",i=>{i.target.closest(".player")&&i.preventDefault()});window.addEventListener("keydown",i=>{const e=document.getElementById("tactical-tab");e&&e.classList.contains("active")&&(i.ctrlKey&&(i.key==="z"||i.key==="Z")&&(i.preventDefault(),console.log("Ctrl+Z pressed, undoing...","History length:",y.length),re()),i.ctrlKey&&(i.key==="d"||i.key==="D")&&(i.preventDefault(),ee()),i.ctrlKey&&(i.key==="s"||i.key==="S")&&(i.preventDefault(),te()),i.ctrlKey&&(i.key==="l"||i.key==="L")&&(i.preventDefault(),de()))});function ee(){h!==null&&!v?(h=null,v=!1,s.style.pointerEvents="none",C("drawOffBtn"),console.log("Modo de desenho desativado (Ctrl+D)")):(S=!1,v=!1,h="line",s.style.pointerEvents="auto",C("drawOnBtn"),document.getElementById("lineBtn").classList.add("active"),console.log("Modo de desenho ativado (Ctrl+D)"),E.trackDraw()),z()}function te(){S?(S=!1,console.log("Modo shadow desativado (Ctrl+S)")):(S=!0,v=!1,h=null,s.style.pointerEvents="none",C("toggleShadowBtn"),console.log("Modo shadow ativado (Ctrl+S)")),z()}function de(){a.clearRect(0,0,s.width,s.height),y=[],V=[],console.log("Tudo limpo: desenhos e shadows (Ctrl+Shift+C)")}function ie(i){alert({pt:{shadowBlocked:`⚠️ Você está com desenho ativo!

Desative o desenho primeiro ou use Ctrl+S para ativar sombra automaticamente.`,drawBlocked:`⚠️ Você está com sombra ativa!

Desative a sombra primeiro ou use Ctrl+D para ativar desenho automaticamente.`},en:{shadowBlocked:`⚠️ You have drawing active!

Disable drawing first or use Ctrl+S to activate shadow automatically.`,drawBlocked:`⚠️ You have shadow active!

Disable shadow first or use Ctrl+D to activate drawing automatically.`},tr:{shadowBlocked:`⚠️ Çizim aktif!

Önce çizimi devre dışı bırakın veya gölgeyi otomatik olarak etkinleştirmek için Ctrl+S kullanın.`,drawBlocked:`⚠️ Gölge aktif!

Önce gölgeyi devre dışı bırakın veya çizimi otomatik olarak etkinleştirmek için Ctrl+D kullanın.`},es:{shadowBlocked:`⚠️ ¡Tienes dibujo activo!

Desactiva el dibujo primero o usa Ctrl+S para activar sombra automáticamente.`,drawBlocked:`⚠️ ¡Tienes sombra activa!

Desactiva la sombra primero o usa Ctrl+D para activar dibujo automáticamente.`}}[l][i])}function C(i){document.querySelectorAll(".shape-menu button, #drawOnBtn, #eraseBtn, #drawOffBtn").forEach(e=>{e.classList.remove("active")}),i&&document.getElementById(i).classList.add("active")}document.getElementById("redFormationSelect").addEventListener("change",()=>{w==="11x11"&&Z(w,B)});document.getElementById("blueFormationSelect").addEventListener("change",()=>{w==="11x11"&&Z(w,B)});class ce{constructor(){this.currentTab="tactical",this.initTabs()}initTabs(){const e=document.querySelectorAll(".tab");document.querySelectorAll(".tab-content"),e.forEach(t=>{t.addEventListener("click",()=>{const n=t.dataset.tab;this.switchTab(n)})})}switchTab(e){switch(document.querySelectorAll(".tab").forEach(t=>t.classList.remove("active")),document.querySelectorAll(".tab-content").forEach(t=>t.classList.remove("active")),document.querySelector(`[data-tab="${e}"]`).classList.add("active"),document.getElementById(`${e}-tab`).classList.add("active"),this.currentTab=e,e){case"replay":this.replayInitialized||(this.initReplayPlayer(),this.replayInitialized=!0);break;case"stream":break;case"videos":!this.videosInitialized&&window.contentManager&&(window.contentManager.loadPublicVideos(),this.videosInitialized=!0);break;case"tutorials":!this.tutorialsInitialized&&window.contentManager&&(window.contentManager.loadPublicTutorials(),this.tutorialsInitialized=!0);break}}initReplayPlayer(){new ue().init()}}class ue{constructor(){this.replay=null,this.isPlaying=!1,this.currentTime=0,this.duration=0,this.players=[],this.canvas=null,this.ctx=null,this.drawCanvas=null,this.drawCtx=null,this.animationFrame=null}init(){this.setupCanvas(),this.setupEventListeners()}setupCanvas(){this.canvas=document.getElementById("replayCanvas"),this.ctx=this.canvas?.getContext("2d"),this.drawCanvas=document.getElementById("replayDrawLayer"),this.drawCtx=this.drawCanvas?.getContext("2d"),this.canvas&&this.drawCanvas&&(this.resizeCanvas(),window.addEventListener("resize",()=>this.resizeCanvas()))}resizeCanvas(){const t=this.canvas.parentElement.getBoundingClientRect();[this.canvas,this.drawCanvas].forEach(n=>{n.width=t.width,n.height=t.height})}setupEventListeners(){const e=document.getElementById("hbr2FileInput"),t=document.getElementById("selectFileBtn"),n=document.getElementById("uploadArea");t?.addEventListener("click",()=>e?.click()),e?.addEventListener("change",r=>{r.target.files[0]&&this.loadReplay(r.target.files[0])}),n?.addEventListener("dragover",r=>{r.preventDefault(),n.classList.add("dragover")}),n?.addEventListener("dragleave",()=>{n.classList.remove("dragover")}),n?.addEventListener("drop",r=>{r.preventDefault(),n.classList.remove("dragover"),r.dataTransfer.files[0]&&this.loadReplay(r.dataTransfer.files[0])}),document.getElementById("playPauseBtn")?.addEventListener("click",()=>this.togglePlayPause()),document.getElementById("stopBtn")?.addEventListener("click",()=>this.stop()),document.getElementById("timelineSlider")?.addEventListener("input",r=>{this.seekTo(parseFloat(r.target.value))}),document.getElementById("replayDrawBtn")?.addEventListener("click",()=>this.setDrawMode("draw")),document.getElementById("replayEraseBtn")?.addEventListener("click",()=>this.setDrawMode("erase")),document.getElementById("replayClearBtn")?.addEventListener("click",()=>this.clearDrawings()),document.getElementById("newReplayBtn")?.addEventListener("click",()=>this.newReplay())}newReplay(){this.stop(),this.replay=null,this.currentTime=0,this.duration=0,this.clearDrawings(),document.getElementById("uploadArea").style.display="block",document.getElementById("replayPlayer").style.display="none",document.getElementById("fileInput").value="";const e=document.getElementById("timelineEvents");e&&(e.innerHTML="")}async loadReplay(e){try{console.log("Carregando arquivo:",e.name);const t=await e.arrayBuffer();this.replay=await this.parseHBR2(t),this.replay&&(console.log("Replay carregado com sucesso:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration||300,this.currentTime=0,this.updateUI(),this.render())}catch(t){console.error("Erro ao carregar replay:",t),this.createDemoReplay()}}createDemoReplay(){this.replay={version:1,duration:300,players:[{id:1,name:"Player 1",team:1,color:16729156},{id:2,name:"Player 2",team:1,color:16729156},{id:3,name:"Player 3",team:1,color:16729156},{id:4,name:"Player 4",team:2,color:4474111},{id:5,name:"Player 5",team:2,color:4474111},{id:6,name:"Player 6",team:2,color:4474111}],events:[{type:"goal",time:45.5,player:"Player 1",team:1},{type:"goal",time:120.3,player:"Player 4",team:2},{type:"goal",time:180.7,player:"Player 2",team:1},{type:"goal",time:250.1,player:"Player 5",team:2}],stadium:{name:"Clássico",width:800,height:400}},console.log("Replay demo criado:",this.replay),this.displayReplayInfo(),this.showPlayer(),this.duration=this.replay.duration,this.currentTime=0,this.updateUI(),this.render()}async parseHBR2(e){try{console.log("Tentando fazer parse do HBR2, tamanho:",e.byteLength);const t=new DataView(e),n=new TextDecoder;if(e.byteLength<16)throw new Error("Arquivo muito pequeno para ser um HBR2 válido");let o=0;const r=t.getUint32(o,!0);o+=4,console.log("Versão detectada:",r);const d={version:r,duration:0,players:[],events:[],frames:[],stadium:null};return console.log("Estrutura básica do HBR2 detectada"),d}catch(t){throw console.error("Erro no parser HBR2:",t),t}}displayReplayInfo(){if(!this.replay)return;const e=this.replay.players?this.replay.players.length:0,t=this.replay.events?this.replay.events.filter(n=>n.type==="goal").length:0;document.getElementById("replayTitle").textContent=`Replay Carregado - ${t} gols`,document.getElementById("replayDuration").textContent=`Duração: ${this.formatTime(this.replay.duration)}`,document.getElementById("replayPlayers").textContent=`Jogadores: ${e}`,document.getElementById("replayMap").textContent=`Mapa: ${this.replay.stadium?.name||"Clássico"}`}showPlayer(){document.getElementById("uploadArea").style.display="none",document.getElementById("replayPlayer").style.display="block"}togglePlayPause(){this.isPlaying=!this.isPlaying;const e=document.getElementById("playPauseBtn");this.isPlaying?(e.textContent="⏸️ Pause",this.play()):(e.textContent="▶️ Play",this.pause())}play(){if(!this.replay)return;const e=()=>{this.isPlaying&&this.currentTime<this.duration?(this.currentTime+=1/60,this.render(),this.updateUI(),this.animationFrame=requestAnimationFrame(e)):this.currentTime>=this.duration&&this.stop()};e()}pause(){this.animationFrame&&cancelAnimationFrame(this.animationFrame)}stop(){this.isPlaying=!1,this.currentTime=0,this.pause(),document.getElementById("playPauseBtn").textContent="▶️ Play",this.updateUI()}seekTo(e){this.currentTime=e/100*this.duration,this.render(),this.updateUI()}render(){!this.ctx||!this.replay||(this.ctx.clearRect(0,0,this.canvas.width,this.canvas.height),this.drawField(),this.drawPlayers(),this.drawTimelineEvents())}drawField(){const e=this.canvas.width,t=this.canvas.height;this.ctx.fillStyle="#4a7c59",this.ctx.fillRect(0,0,e,t),this.ctx.strokeStyle="white",this.ctx.lineWidth=3,this.ctx.beginPath(),this.ctx.rect(40,40,e-80,t-80),this.ctx.moveTo(e/2,40),this.ctx.lineTo(e/2,t-40),this.ctx.arc(e/2,t/2,60,0,Math.PI*2),this.ctx.moveTo(e/2+60,t/2);const n=120,o=80,r=(t-o)/2;this.ctx.rect(40,r,n,o),this.ctx.rect(e-40-n,r,n,o);const d=8,p=40,u=(t-p)/2;this.ctx.rect(40-d,u,d,p),this.ctx.rect(e-40,u,d,p),this.ctx.stroke()}drawPlayers(){if(!this.replay.players)return;this.replay.players.forEach((n,o)=>{const r=100+o%3*200,d=100+Math.floor(o/3)*100,p=r+Math.sin(this.currentTime*.5+o)*50,u=d+Math.cos(this.currentTime*.3+o)*30;this.ctx.beginPath(),this.ctx.arc(p,u,18,0,Math.PI*2),this.ctx.fillStyle=n.team===1?"#ff4444":"#4444ff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke(),this.ctx.fillStyle="white",this.ctx.font="bold 11px Arial",this.ctx.textAlign="center",this.ctx.fillText(n.name,p,u+3)});const e=this.canvas.width/2+Math.sin(this.currentTime)*100,t=this.canvas.height/2+Math.cos(this.currentTime*1.2)*50;this.ctx.beginPath(),this.ctx.arc(e,t,8,0,Math.PI*2),this.ctx.fillStyle="#ffffff",this.ctx.fill(),this.ctx.strokeStyle="black",this.ctx.lineWidth=2,this.ctx.stroke()}drawTimelineEvents(){if(!this.replay.events)return;const e=document.getElementById("timelineEvents");e&&(e.innerHTML="",this.replay.events.forEach(t=>{const n=document.createElement("div");n.className=`timeline-event ${t.type}`,n.style.left=`${t.time/this.duration*100}%`,n.title=`${t.type.toUpperCase()}: ${t.player} (${this.formatTime(t.time)})`,n.addEventListener("click",()=>{this.currentTime=t.time,this.updateUI(),this.render()}),e.appendChild(n)}))}updateUI(){const e=document.getElementById("timelineSlider"),t=document.getElementById("timeDisplay");e&&(e.value=this.currentTime/this.duration*100||0),t&&(t.textContent=`${this.formatTime(this.currentTime)} / ${this.formatTime(this.duration)}`)}formatTime(e){const t=Math.floor(e/60),n=Math.floor(e%60);return`${t.toString().padStart(2,"0")}:${n.toString().padStart(2,"0")}`}setDrawMode(e){this.drawMode=e,document.querySelectorAll(".replay-toolbar button").forEach(t=>t.classList.remove("active")),e==="draw"?(document.getElementById("replayDrawBtn").classList.add("active"),this.drawCanvas.style.cursor="crosshair"):e==="erase"?(document.getElementById("replayEraseBtn").classList.add("active"),this.drawCanvas.style.cursor="grab"):this.drawCanvas.style.cursor="default",e==="draw"&&this.setupDrawingEvents()}setupDrawingEvents(){let e=!1,t=0,n=0;this.drawCanvas.onmousedown=o=>{e=!0,[t,n]=[o.offsetX,o.offsetY],o.button===0?this.drawCtx.strokeStyle=document.getElementById("leftClickColor").value:o.button===2&&(this.drawCtx.strokeStyle=document.getElementById("rightClickColor").value,o.preventDefault()),this.drawCtx.lineWidth=document.getElementById("brushSize").value,this.drawCtx.lineCap="round"},this.drawCanvas.onmousemove=o=>{e&&(this.drawCtx.beginPath(),this.drawCtx.moveTo(t,n),this.drawCtx.lineTo(o.offsetX,o.offsetY),this.drawCtx.stroke(),[t,n]=[o.offsetX,o.offsetY])},this.drawCanvas.onmouseup=()=>{e=!1},this.drawCanvas.oncontextmenu=o=>{o.preventDefault()}}clearDrawings(){this.drawCtx&&this.drawCtx.clearRect(0,0,this.drawCanvas.width,this.drawCanvas.height)}}document.addEventListener("DOMContentLoaded",()=>{new ce});document.getElementById("drawOnBtn").onclick=()=>{if(S){ie("drawBlocked");return}ee()};document.getElementById("drawOffBtn").onclick=()=>{v=!1,h=null,s.style.pointerEvents="none",C("drawOffBtn")};document.getElementById("eraseBtn").onclick=()=>{S=!1,v=!0,h=null,s.style.pointerEvents="auto",C("eraseBtn"),z()};document.getElementById("clearBtn").onclick=()=>{a.clearRect(0,0,s.width,s.height),y=[],V=[]};document.getElementById("freeBtn").onclick=()=>{v=!1,h="free",s.style.pointerEvents="auto",C("freeBtn")};document.getElementById("lineBtn").onclick=()=>{v=!1,h="line",s.style.pointerEvents="auto",C("lineBtn")};document.getElementById("squareBtn").onclick=()=>{v=!1,h="square",s.style.pointerEvents="auto",C("squareBtn")};document.getElementById("triangleBtn").onclick=()=>{v=!1,h="triangle",s.style.pointerEvents="auto",C("triangleBtn")};document.getElementById("circleBtn").onclick=()=>{v=!1,h="circle",s.style.pointerEvents="auto",C("circleBtn")};document.getElementById("arrowBtn").onclick=()=>{v=!1,h="arrow",s.style.pointerEvents="auto",C("arrowBtn")};document.getElementById("primaryColorPicker").addEventListener("change",i=>{Y=i.target.value});document.getElementById("secondaryColorPicker").addEventListener("change",i=>{q=i.target.value});document.getElementById("redShadowColorPicker").addEventListener("change",i=>{j=i.target.value});document.getElementById("blueShadowColorPicker").addEventListener("change",i=>{F=i.target.value});document.getElementById("tipsBtn").onclick=()=>{alert({pt:`💡 DICAS:

• Ctrl+Z: Desfazer última ação
• Ctrl+D: Ativar/Desativar modo desenho
• Ctrl+S: Ativar/Desativar modo shadow
• Ctrl+L: Limpar tudo (desenhos + shadows)
• Botão Esquerdo: Desenhar com cor primária
• Botão Direito: Desenhar com cor secundária
• Ative sombra e segure o jogador com botão direito e arraste para criar um rastro de movimento`,en:`💡 TIPS:

• Ctrl+Z: Undo last action
• Ctrl+D: Toggle draw mode
• Ctrl+S: Toggle shadow mode
• Ctrl+L: Clear everything (drawings + shadows)
• Left Click: Draw with primary color
• Right Click: Draw with secondary color
• Activate shadow and hold the player with right mouse button and drag to create a movement trail`,tr:`💡 İPUÇLARI:

• Ctrl+Z: Son işlemi geri al
• Ctrl+D: Çizim modunu aç/kapat
• Ctrl+S: Gölge modunu aç/kapat
• Ctrl+L: Her şeyi temizle (çizimler + gölgeler)
• Sol Tık: Birincil renkle çiz
• Sağ Tık: İkincil renkle çiz
• Gölgeyi etkinleştirip oyuncuya sağ tıkla ve sürükle, hareket izi oluştur`,es:`💡 CONSEJOS:

• Ctrl+Z: Deshacer última acción
• Ctrl+D: Activar/Desactivar modo dibujo
• Ctrl+S: Activar/Desactivar modo sombra
• Ctrl+L: Limpiar todo (dibujos + sombras)
• Clic Izquierdo: Dibujar con color primario
• Clic Derecho: Dibujar con color secundario
• Activa sombra y mantén el jugador con botón derecho y arrastra para crear una estela de movimiento`}[l])};document.getElementById("toggleShadowBtn").onclick=()=>{if(h!==null&&!v){ie("shadowBlocked");return}te()};document.getElementById("downloadBtn").onclick=()=>{E.trackDownload();const i=document.createElement("canvas");i.width=x.clientWidth,i.height=x.clientHeight;const e=i.getContext("2d"),t=new Image;t.crossOrigin="anonymous",t.onload=()=>{e.drawImage(t,0,0,i.width,i.height),e.drawImage(s,0,0);let o=0;const r=A.length;if(r===0){X(i);return}A.forEach(d=>{const p=new Image;p.onload=()=>{const u=d.size||29,b=document.createElement("canvas");b.width=u,b.height=u;const f=b.getContext("2d");f.beginPath(),f.arc(u/2,u/2,u/2-2,0,Math.PI*2),f.fillStyle=getComputedStyle(d.el).backgroundColor,f.fill(),f.strokeStyle=getComputedStyle(d.el).borderColor,f.lineWidth=2,f.stroke(),d.id&&(f.font=`bold ${Math.max(10,u*.4)}px Arial, sans-serif`,f.fillStyle=getComputedStyle(d.el).color,f.textAlign="center",f.textBaseline="middle",f.fillText(d.el.textContent,u/2,u/2));const M=x.getBoundingClientRect(),G=d.x*M.width-u/2,ae=d.y*M.height-u/2;e.drawImage(b,G,ae),o++,o===r&&X(i)},p.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///yH5BAEAAAAALAAAAAABAAEAAAIBRAA7"})};const n=I[w][B];t.src=n.backgroundImage};function X(i){const e=document.createElement("a");e.download=`quadro-tatico-${w}-${B}.png`,e.href=i.toDataURL("image/png"),e.click()}class me{constructor(){this.adminPasswordHash="a8b2c1d4e5f6789012345678901234567890abcdef",this.videos=JSON.parse(localStorage.getItem("videos")||"[]"),this.tutorials=JSON.parse(localStorage.getItem("tutorials")||"[]"),this.initContent()}simpleHash(e){let t=0;if(e.length===0)return t;for(let n=0;n<e.length;n++){const o=e.charCodeAt(n);t=(t<<5)-t+o,t=t&t}return Math.abs(t).toString(16)}verifyPassword(e){const t=this.simpleHash(e),n=this.simpleHash("jojos13");return t===n}initContent(){this.loadPublicVideos(),this.loadPublicTutorials()}authenticateVideos(){const e=document.getElementById("videosPassword").value;this.verifyPassword(e)?(document.getElementById("videosLoginForm").style.display="none",document.getElementById("videosAdminPanel").style.display="block",this.loadAdminVideos()):alert("Senha incorreta!")}authenticateTutorials(){const e=document.getElementById("tutorialsPassword").value;this.verifyPassword(e)?(document.getElementById("tutorialsLoginForm").style.display="none",document.getElementById("tutorialsAdminPanel").style.display="block",this.loadAdminTutorials()):alert("Senha incorreta!")}addVideo(){const e=document.getElementById("videoTitle").value,t=document.getElementById("videoUrl").value;if(!e||!t){alert("Preencha todos os campos!");return}const n=this.extractYouTubeId(t);if(!n){alert("URL do YouTube inválida!");return}const o={id:Date.now(),title:e,url:t,videoId:n,embedUrl:`https://www.youtube.com/embed/${n}`,createdAt:new Date().toLocaleDateString()};this.videos.push(o),localStorage.setItem("videos",JSON.stringify(this.videos)),document.getElementById("videoTitle").value="",document.getElementById("videoUrl").value="",this.loadAdminVideos(),this.loadPublicVideos()}extractYouTubeId(e){const t=/(?:youtube\.com\/watch\?v=|youtu\.be\/)([a-zA-Z0-9_-]{11})/,n=e.match(t);return n?n[1]:null}removeVideo(e){this.videos=this.videos.filter(t=>t.id!==e),localStorage.setItem("videos",JSON.stringify(this.videos)),this.loadAdminVideos(),this.loadPublicVideos()}loadAdminVideos(){const e=document.getElementById("videosList");e.innerHTML=this.videos.map(t=>`
      <div class="content-item">
        <h3>${t.title}</h3>
        <iframe width="100%" height="200" src="${t.embedUrl}" frameborder="0" allowfullscreen></iframe>
        <p>Adicionado em: ${t.createdAt}</p>
        <button onclick="contentManager.removeVideo(${t.id})" style="background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px;">Remover</button>
      </div>
    `).join("")}loadPublicVideos(){const e=document.getElementById("publicVideosList");if(this.videos.length===0){e.innerHTML='<p style="text-align: center; color: #aaa;">Nenhum vídeo disponível no momento.</p>';return}e.innerHTML=this.videos.map(t=>`
      <div class="content-item">
        <h3>${t.title}</h3>
        <iframe width="100%" height="200" src="${t.embedUrl}" frameborder="0" allowfullscreen></iframe>
        <p>Publicado em: ${t.createdAt}</p>
      </div>
    `).join("")}addTutorial(){const e=document.getElementById("tutorialTitle").value,t=document.getElementById("tutorialContent").value;if(!e||!t){alert("Preencha todos os campos!");return}const n={id:Date.now(),title:e,content:t,createdAt:new Date().toLocaleDateString()};this.tutorials.push(n),localStorage.setItem("tutorials",JSON.stringify(this.tutorials)),document.getElementById("tutorialTitle").value="",document.getElementById("tutorialContent").value="",this.loadAdminTutorials(),this.loadPublicTutorials()}removeTutorial(e){this.tutorials=this.tutorials.filter(t=>t.id!==e),localStorage.setItem("tutorials",JSON.stringify(this.tutorials)),this.loadAdminTutorials(),this.loadPublicTutorials()}loadAdminTutorials(){const e=document.getElementById("tutorialsList");e.innerHTML=this.tutorials.map(t=>`
      <div class="content-item">
        <h3>${t.title}</h3>
        <div>${t.content}</div>
        <p>Adicionado em: ${t.createdAt}</p>
        <button onclick="contentManager.removeTutorial(${t.id})" style="background: #ff4444; color: white; border: none; padding: 5px 10px; border-radius: 3px;">Remover</button>
      </div>
    `).join("")}loadPublicTutorials(){const e=document.getElementById("publicTutorialsList");if(this.tutorials.length===0){e.innerHTML='<p style="text-align: center; color: #aaa;">Nenhum tutorial disponível no momento.</p>';return}e.innerHTML=this.tutorials.map(t=>`
      <div class="content-item">
        <h3>${t.title}</h3>
        <div>${t.content}</div>
        <p>Publicado em: ${t.createdAt}</p>
      </div>
    `).join("")}}let D;function ye(){D.authenticateVideos()}function he(){D.authenticateTutorials()}function ge(){D.addVideo()}function pe(){D.addTutorial()}window.authenticateVideos=ye;window.authenticateTutorials=he;window.addVideo=ge;window.addTutorial=pe;document.addEventListener("DOMContentLoaded",()=>{const i=document.getElementById("drawOffBtn");i&&i.click(),J(),z(),s&&x&&N(),D=new me,window.contentManager=D,setTimeout(()=>{E.trackVisit()},100)});
